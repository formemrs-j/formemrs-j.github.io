<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>SSCN模型分析</title>
      <link href="/2021/12/07/sscn-mo-xing-fen-xi/"/>
      <url>/2021/12/07/sscn-mo-xing-fen-xi/</url>
      
        <content type="html"><![CDATA[<h1 id="demo-run-py"><a href="#demo-run-py" class="headerlink" title="demo_run.py"></a>demo_run.py</h1><h2 id="read-dictionary-from-file"><a href="#read-dictionary-from-file" class="headerlink" title="read_dictionary_from_file"></a>read_dictionary_from_file</h2><p>没有学习过<code>pandas</code>和<code>tensorflow</code>，所以理解代码采用边学习边分析的方式</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">def read_dictionary_from_file(md, table_name, key="word", value="wordid"):    df = pd.read_csv("%s/dicts/%s.csv"%(DEMO_DATA_PATH, table_name))    df = df[[key, value]]    dct = {}    for word, id in df.values.tolist():        dct[word] = id    return dct<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>方法<code>pd.read_csv</code>读取demo_data/dicts文件夹下的.csv文件(<code>DEMO_DATA_PATH</code>路径指向CONFIG.py中的<code>DEMO_DATA_PATH = HOME_PATH + "/demo_data"</code>)</p><p>我们尝试构造一个简单的d.csv文件来查看该方法的返回值</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">word,name,wordid北京,北京,2北京,北京,2北京,北京,2北京,北京,2<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">#测试的小demoimport pandas as pddf=pd.read_csv("d.csv")df = df[['word','wordid']]print(df)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://gitee.com/wwj1026/image/raw/master/20211209/inG@RXE*pjFg.png"></p><p>可以看到返回的是表格型的数据结构，比.csv文件用逗号分隔更直观，接着<code>df = df[[key, value]]</code>只读取<code>word``wordid</code>这两列数据，然后定义一个空字典<code>dct</code>，我们尝试调用<code>df.values.tolist()</code>来查看它的返回值</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">print(df.values.tolist())<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="https://gitee.com/wwj1026/image/raw/master/20211209/QU@sBNsbYkzd.png"></p><p>可以看到该方法将读取的数据构造成一个二维数组，那么后面的就好理解了，用for循环遍历这个二位数组，并将每一个数组元素转换成字典的形式，我们尝试调用一下</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">for word,id in df.values.tolist():    dct[word]=id    print(dct)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p><img src="https://gitee.com/wwj1026/image/raw/master/20211209/!VQA@gWpWfVM.png"></p><p>可以看到结果就是我们预测的那样，最后返回构造的字典</p><p><strong>总结：函数read_dictionary_from_file处理/demo/dict文件夹下的csv文件 返回处理好的字典，字典的组成为{‘word’,’wordid’}</strong></p><h2 id="temptation2lst"><a href="#temptation2lst" class="headerlink" title="temptation2lst"></a>temptation2lst</h2><pre class="line-numbers language-python" data-language="python"><code class="language-python">def temptation2lst(temptation_str, dct_temptation):    lst = []    for key in dct_temptation.keys():        if temptation_str.find(key) != -1:            lst.append(dct_temptation[key])    return lst<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>这个函数传入的两个参数，定义了一个空列表，用for循环遍历传入的字典(应该是)，如果有找到key的值，那么把数据添加到这个列表里，返回这个列表</p><p><strong>总结：函数temptation2lst遍历传入的dct_temptation的键和temptation_str的键进行比较，相同就把键对应的值加入到列表lst中</strong></p><h2 id="compare-ret-这个函数在demo-run-py并没有调用"><a href="#compare-ret-这个函数在demo-run-py并没有调用" class="headerlink" title="compare_ret() (这个函数在demo_run.py并没有调用)"></a><del>compare_ret() (这个函数在demo_run.py并没有调用)</del></h2><pre class="line-numbers language-python" data-language="python"><code class="language-python">def compare_ret(id): # [4,5,9,31,37,38,41,46,74,76]    with open("%s/%s/input_skillfeat.pkl" % (DATA_PATH, "IT"), 'rb') as f:        dct = pickle.load(f, encoding='utf-8')        # JD data        time_ids = dct['time_index'][id]        salaries = dct['salary'][id]        ids = dct['id'][id]        skill_sets = dct['skill_set'][id]        comp_ids = dct['comp_id'][id]        city_ids = dct['city_id'][id]        work_years = dct['job_work_year'][id]        temptations = dct['job_temptation'][id]        return time_ids, salaries, ids, skill_sets, comp_ids, city_ids, work_years, temptations<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">import pprint, picklepkl_file = open('b.pkl', 'rb')data1 = pickle.load(pkl_file,encoding='utf-8')print(data1)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>尝试调用并打印出来，发现数据太多了，跑了一点大概可以看出反序列化后是<code>二维元组？</code></p><p><img src="https://gitee.com/wwj1026/image/raw/master/20211209/^Lap4w^aLm2P.png"></p><p>其中<code>.pkl</code>是python独有的一种文件储存格式，需要用<code>pickle</code>包来反序列化，返回的应该是元组类型的数据，然后读取，<code>time_ids</code>,<code>salaries</code>……等各项数据并返回</p><h2 id="read-dict-md"><a href="#read-dict-md" class="headerlink" title="read_dict(md)"></a>read_dict(md)</h2><pre class="line-numbers language-python" data-language="python"><code class="language-python">def read_dict(md):    dct_compname = read_dictionary_from_file(md, "company_dct", key="name")    dct_comp = read_dictionary_from_file(md, "company_dct")    dct_city = read_dictionary_from_file(md, "city_dct")    dct_time = read_dictionary_from_file(md, "time_dct")    dct_workyear = read_dictionary_from_file(md, "workyear_dct")    dct_temptation = read_dictionary_from_file(md, "tempt_dct")    dct_skill = read_dictionary_from_file(md, "skill_dct", key="merge")    dct_level = read_dictionary_from_file(md, "level_dct")    return dct_compname, dct_comp, dct_city, dct_time, dct_workyear, dct_temptation, dct_skill, dct_level<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>调用<code>read_dictionary_from_file</code>函数，依次读取<code>demo_data/dicts</code>下的.csv文件并返回操作后的字典数据</p><p><img src="https://gitee.com/wwj1026/image/raw/master/20211209/Mbdo9S9HtJcd.png"></p><p>返回字典的格式为</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">{'word','wordid'}#word和wordid都是csv文件的属性值<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><strong>总结：函数read_dict(md)调用read_dictionary_from_file，读取并返回{‘word’,’wordid’}这种格式的字典</strong></p><h2 id="transform-jd"><a href="#transform-jd" class="headerlink" title="transform_jd"></a>transform_jd</h2><pre class="line-numbers language-python" data-language="python"><code class="language-python">def transform_jd(md, row_dct):    dct_compname, dct_comp, dct_city, dct_time, dct_workyear, dct_temptation, dct_skill, dct_level = read_dict(md)    # id, time, comp_id, job_title, job_salary, job_address, job_work_year, job_temptation, skill_set    id = int(row_dct['id'])    time_str = row_dct['time']    year = int(time_str.split('/')[0].split('-')[0])    half_year = (int(time_str.split('/')[0].split('-')[1]) - 1) / 6    time_id = int((year - 2016) * 2 + half_year)    comp = row_dct['comp_id']    job_salary = row_dct['job_salary']    job_address = row_dct['job_address']    job_work_year = row_dct['job_work_year']    job_temptation = row_dct['job_temptation']    skill_set_text = row_dct['skill_set']    city_id = dct_city[job_address]    comp_id = int(dct_comp[comp])    salaries = get_low_high(job_salary)    work_year = dct_workyear[job_work_year]    temptation = temptation2lst(job_temptation, dct_temptation)    # time_id = dct_time[time_str]    skill_set = sorted([(dct_level[dct['level']], dct_skill[dct['skill']]) for dct in json.loads(skill_set_text)], key=lambda x: x[1])    return [time_id], [salaries], [id], [skill_set], [comp_id], [city_id], [work_year], [temptation]<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">dct_compname, dct_comp, dct_city, dct_time, dct_workyear, dct_temptation, dct_skill, dct_level = read_dict(md)<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>将函数<code>read_dict</code>的返回值依次赋值给变量方便调用，接下来就是取出<code>row_dict</code>的各项的值，我们找到变量<code>row_dict</code>定义的地方，在第189行，我们发现了这么一行</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">row_dct = pd.read_csv("%s/demo_input.csv"%DEMO_DATA_PATH).to_dict(orient="records")[0]<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>我们尝试自己写一个小demo看看row_dct的返回值</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">import pandas as pdrow_dct = pd.read_csv("demo_input.csv").to_dict(orient="records")[0]print(row_dct)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>返回结果如下</p><p><img src="https://gitee.com/wwj1026/image/raw/master/20211209/J3fki2zi4Vf6.png"></p><p>那这就很清楚了，读取<code>demo_data/demo_input.cv</code>文件并用方法<code>to_dict</code>将读取的数据转换成字典，然后函数<code>transform_jd</code>再去调用字典的各项的值</p><p>其中注意这么两个参数，<code>job_temptation</code>和<code>dct_temptation</code>我们就发现了函数<code>temptation2lst</code>传入的两个参数的来源</p><p>我们先看看<code>job_temptation</code>是个啥，调用一下</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">import pandas as pdrow_dct = pd.read_csv("demo_input.csv").to_dict(orient="records")[0]# print(row_dct)job_temptation = row_dct['job_temptation']print(job_temptation)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>结果如下</p><p><img src="https://gitee.com/wwj1026/image/raw/master/20211209/t59x^eZwZWcO.png"></p><p>返回的是一个列表，里面有两个字典元素，<code>temptation</code>属性翻译一下在这里应该是工作福利的意思</p><p>我们再来看看另一个参数<code>dct_temptation</code>，我们查找它的来源，发现了这么一行</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">dct_temptation = read_dictionary_from_file(md, "tempt_dct")<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>分析过了<code>read_dictionary_from_file</code>我们就可以很容易知道，这一串返回的应该也是字典数据，结构应该是如下的结构</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">{'朝九晚五':11}{'自由':22}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>接下来注意到这么一行</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">temptation = temptation2lst(job_temptation, dct_temptation)<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>由于我们已经分析过第二个函数，所以我们可以知道，<code>temptation</code>应该是一个列表，我们可以写一个demo验证一下</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">lst = []def temptation2lst(temptation_str, dct_temptation):    for key in dct_temptation.keys():        if temptation_str.find(key) != -1:            lst.append(dct_temptation[key])    return lstif __name__ == '__main__':    job_temptation=[{"temptation":"1金"},{"temptation":"六险"}]    dct_temptation={'1金':11}    temptation2lst(job_temptation,dct_temptation)    print(lst)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>注意这么一句<code>for key in dct_temptation.keys()</code>这一句遍历了<code>dct_temptation</code>字典里所有的键，其实也就是文件<code>tempt_dct.csv</code>的所有word属性(如下图)，然后与<code>job_temptation</code>里的键进行对比，如果相等，就把对应<code>dct_temptation</code>的值加入到<code>lst</code>中返回</p><img src="https://gitee.com/wwj1026/image/raw/master/20211209/ZCW5MXjQuHsx.png" style="zoom:40%;"><p>那么<code>temptation</code>就是调用后返回的<code>lst</code></p><p><strong>总结：函数transform_jd处理read_dct返回的{‘word’,’wordid’}这种格式的字典，读取他们对应的值，填入列表并返回</strong></p><h2 id="input-generate"><a href="#input-generate" class="headerlink" title="input_generate"></a>input_generate</h2><pre class="line-numbers language-python" data-language="python"><code class="language-python">def input_generate(md, row_dct):    # ------------------- read information --------------    with open("%s/%s/input_skillfeat.pkl" % (DATA_PATH, md) , 'rb') as f:        dct = pickle.load(f, encoding='utf-8')    # dims    n_time = dct['n_time']    n_skill = dct['n_skill']    n_level = dct['n_level']    n_comp = dct['n_comp']    n_city = dct['n_city']    n_tempt = dct['n_tempt']    n_workyear = dct['n_workyear']    maxlen_skill = dct['maxlen_skill']    n_industry = max([max(u[-1]) for u in dct['feat_comp']]) + 1    time_ids, salaries, ids, skill_sets, comp_ids, city_ids, work_years, temptations = transform_jd(md, row_dct)    # skill data    data_skill_feat = dct['time_skill_feat']    # company data    feat_comp = dct['feat_comp']    feat_time_city = dct['feat_time_city']    # dictionaries    comp_ind_dict = dct['comp_ind_dict']    city_ind_dict = ['city_ind_dict']    data_id, data_salary, data_skill_has, data_skill_id, data_level_id, data_comp_id, \    data_city_id, data_time_id, data_target_id, data_work_year, data_temptation = [], [], [], [], [], [], [], [], [], [], []    dim_skill = len(data_skill_feat[0][0])    # ------------------- generate jd data ------------------    for id, skill_set, comp_id, city_id, time_id, salary, work_year, tempt in zip(ids, skill_sets, comp_ids, city_ids,                                                                                  time_ids, salaries, work_years, temptations):        skill_index = [0] * maxlen_skill        level_index = [0] * maxlen_skill        skill_has = [0] * maxlen_skill        for i, level_skill in enumerate(skill_set):            skill_index[i] = level_skill[1]            level_index[i] = level_skill[0]            skill_has[i] = 1        data_tempt = [0] * n_tempt        for tempt_id in tempt:            data_tempt[tempt_id] = 1        for i in [0, 2]:            if salary[i] == -1 or time_id == 0:  # or i == 2:                continue            data_id.append(id)            data_salary.append(salary[i])            data_skill_has.append(skill_has)            data_skill_id.append(skill_index)            data_level_id.append(level_index)            data_comp_id.append(comp_id)            data_city_id.append(city_id)            data_time_id.append(time_id - 1)            data_work_year.append(work_year)            data_temptation.append(data_tempt)            target_ind = [0, 0]            target_ind[min(i, 1)] = 1            data_target_id.append(target_ind)    # company data    data_comp_feat_id, data_comp_feat_val, data_comp_industry = [], [], []    city_val_count = max([feat[2] for feat in feat_comp]) + 1    dim_comp = 4    comp_featsize = 0    for feat in feat_comp:        company_feat_value = feat[:2] + [1, 1]  # FM输入        company_feat_index = [0, 1] + [feat[2] + 2, feat[3] + 2 + city_val_count]        comp_featsize = max(comp_featsize, feat[3] + 2 + city_val_count + 1)        industry_fields = feat[-1]        industry_feat = [0] * n_industry        for field in industry_fields:            industry_feat[field] = 1        data_comp_feat_id.append(company_feat_index)        data_comp_feat_val.append(company_feat_value)        data_comp_industry.append(industry_feat)    # city data    dim_city = len(feat_time_city[0][0])        return (n_time, n_comp, n_industry, n_city, n_skill, n_level, n_tempt, n_workyear, dim_comp, dim_city, dim_skill,            comp_featsize, maxlen_skill), \           (data_comp_feat_id, data_comp_feat_val, data_comp_industry, feat_time_city, data_skill_feat), \           (data_id, data_salary, data_skill_has, data_skill_id, data_level_id, data_comp_id, data_city_id,            data_time_id, data_work_year, data_temptation, data_target_id), (comp_ind_dict, city_ind_dict)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>打开<code>input_skillfeat.pkl</code>文件，反序列化<code>input_skillfeat.pkl</code>文件并返回字典<code>dct</code>，读取字典的各项如：</p><p><code>n_time</code>,<code>n_skill</code>,……<code>n_industry</code>等，然后结合函数<code>transform_jd</code>的返回值</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">time_ids, salaries, ids, skill_sets, comp_ids, city_ids, work_years, temptations = transform_jd(md, row_dct)<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>继续往下看，注意这么一句</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">for id, skill_set, comp_id, city_id, time_id, salary, work_year, tempt in zip(ids, skill_sets, comp_ids, city_ids,time_ids, salaries, work_years, temptations):<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>查了一下 <code>for in zip</code>的用法，也是序列解包，也就是用这些变量接收序列解包字典后的值</p><p>后面的这一段就不太理解了,不懂这些运算的意义是啥</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">time_ids, salaries, work_years, temptations):       skill_index = [0] * maxlen_skill       level_index = [0] * maxlen_skill       skill_has = [0] * maxlen_skill       for i, level_skill in enumerate(skill_set):           skill_index[i] = level_skill[1]           level_index[i] = level_skill[0]           skill_has[i] = 1       data_tempt = [0] * n_tempt       for tempt_id in tempt:           data_tempt[tempt_id] = 1       for i in [0, 2]:           if salary[i] == -1 or time_id == 0:  # or i == 2:               continue           data_id.append(id)           data_salary.append(salary[i])           data_skill_has.append(skill_has)           data_skill_id.append(skill_index)           data_level_id.append(level_index)           data_comp_id.append(comp_id)           data_city_id.append(city_id)           data_time_id.append(time_id - 1)           data_work_year.append(work_year)           data_temptation.append(data_tempt)           target_ind = [0, 0]           target_ind[min(i, 1)] = 1           data_target_id.append(target_ind)   # company data   data_comp_feat_id, data_comp_feat_val, data_comp_industry = [], [], []   city_val_count = max([feat[2] for feat in feat_comp]) + 1   dim_comp = 4   comp_featsize = 0   for feat in feat_comp:       company_feat_value = feat[:2] + [1, 1]  # FM输入       company_feat_index = [0, 1] + [feat[2] + 2, feat[3] + 2 + city_val_count]       comp_featsize = max(comp_featsize, feat[3] + 2 + city_val_count + 1)       industry_fields = feat[-1]       industry_feat = [0] * n_industry       for field in industry_fields:           industry_feat[field] = 1       data_comp_feat_id.append(company_feat_index)       data_comp_feat_val.append(company_feat_value)       data_comp_industry.append(industry_feat)   # city data   dim_city = len(feat_time_city[0][0])<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>总结：前半段对数据解包，并且获取，后半段数据的运算没看懂</strong></p><h2 id="name-‘main‘"><a href="#name-‘main‘" class="headerlink" title="name== ‘main‘"></a><strong>name</strong>== ‘<strong>main</strong>‘</h2><pre class="line-numbers language-python" data-language="python"><code class="language-python">if __name__== '__main__':    starttime = time()    os.environ['CUDA_VISIBLE_DEVICES'] = '2'    row_dct = pd.read_csv("%s/demo_input.csv"%DEMO_DATA_PATH).to_dict(orient="records")[0]    data_G = read_graph(dataset_name)    data_skill_mat = read_w2v(dataset_name)    # ------------------- read information --------------    with open("%s/%s/input_skillfeat.pkl" % (DATA_PATH, dataset_name), 'rb') as f:        dct = pickle.load(f, encoding='utf-8')    # print(transform_jd("IT", row_dct))    params, side_data, data, dicts = input_generate(dataset_name, row_dct)    n_time, n_comp, n_industry, n_city, n_skill, n_level, n_tempt, n_workyear, dim_comp, dim_city, dim_skill, comp_featsize, maxlen_skill = params    data_comp_feat_id, data_comp_feat_val, data_comp_industry, feat_time_city, data_skill_feat = side_data    skill_list, level_list = read_skill_level_list(n_skill, n_level, dataset_name)    # 读取数据时间    model = SSCN(n_time, n_city, n_comp, n_industry, n_skill, n_level, n_tempt, n_workyear, dim_city, dim_skill, dim_comp,                 comp_featsize, maxlen_skill, feat_time_city, data_comp_feat_val, data_comp_feat_id, data_comp_industry, data_skill_mat, data_skill_feat, data_G, time_reg=1,                 fm_embsize=16, dropout_fm_feed=[0.8, 0.8], dim_skill_share=10,dim_skill_own=6,                 deep_share=[64, 64, 64], dropout_share_feed=[0.6, 0.6, 0.8, 0.8], l2_reg=0.3,                 deep_value=[16, 16, 16], dropout_value_feed=[0.8, 1.0, 1.0, 1.0],                 deep_impact=[16, 16, 16], dropout_impact_feed=[1.0, 1.0, 1.0, 1.0],                 gcn_layers=[16, 16], dropout_gcn_feed=[1.0, 1.0, 1.0],                 activation=tf.nn.leaky_relu, learning_rate=0.001, verbose=1, random_seed=2019, batch_size=256)    model.load_model("%s/model_save/SSCN" % SAVE_PATH_NOW)    # model evaluation    predictions = model.predict(data)    print(predictions)    # save intermediate variables    df_val = model.get_skill_value(data)    df_val['skill_name'] = df_val['skill'].apply(lambda x: skill_list[x])    df_val['level_name'] = df_val['level'].apply(lambda x: level_list[x])    make_path('%s'%DEMO_OUT_PATH)    df_val.to_csv('%s/demo_value.csv'%DEMO_OUT_PATH, index=False)    endtime = time()    print("Demo Time %fs"%(endtime-starttime)) # 20s<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>由上往下，<code>starttime = time()</code>这一句开始计时，接着<code>os.environ['CUDA_VISIBLE_DEVICES'] = '2'</code>指定编号为2的GPU对程序可见，接着读取<code>demo_input.csv</code>文件，得到<code>row_dct</code>文件</p><p>我们注意到下面这句：</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">data_G = read_graph(dataset_name)<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>我们查看一下<code>read_graph</code>的原型</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">def read_graph(md):    with open("%s/%s/skill_graph_one.pkl"%(DATA_PATH, md), 'rb') as f:        G = pickle.load(f, encoding='bytes')    return G<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>也就是<code>data_G</code>实际上就是对<code>/data/save/IT</code>文件夹下的<code>skill_graph_one.pkl</code>数据进行读取，然后返回列表？(猜测是)</p><p>再看下面一句</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">data_skill_mat = read_w2v(dataset_name)<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>看一下函数原型</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">def read_w2v(md):    df = pd.read_csv("%s/%s/w2v.csv"%(DATA_PATH, md)).drop("skill", axis=1)    df = df.sort_values(by='skill_id', ascending=True)    return df.drop("skill_id", axis=1).values<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>大概的意思是读取<code>w2v.csv</code>文件，取出<code>skill_id</code>这一列的数据？(应该是),并返回</p><p>接下来就是<code>row_dct</code>字典的生成语句，序列解包<code>input_skillfeat.pkl</code>文件生成<code>row_dct</code> 再将<code>row_dct</code>作为参数传入函数<code>input_generate</code>将返回值序列解包给<code> params, side_data, data, dicts</code>这些变量</p><p>再把<code>params</code>和<code>side_data</code>分别解包赋值，将得到的两个参数<code>n_skill</code>,<code>n_level</code>分别传入函数<code>read_skill_level_list</code></p><pre class="line-numbers language-python" data-language="python"><code class="language-python">skill_list, level_list = read_skill_level_list(n_skill, n_level, dataset_name)<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>我们看一下函数原型</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">def read_skill_level_list(n_skill, n_level, md):    with open("%s/%s/skill_level_dict.pkl"%(DATA_PATH, md), 'rb') as f:        filtered_skill_dct, skill_ind_dct, level_dct, level_ind_dct, tempt_dct, tempt_ind_dct = pickle.load(f)    skill_lst = [[] for i in range(n_skill)]    level_lst = [[] for i in range(n_level)]    for skill, ind in skill_ind_dct.items():        skill_lst[ind] = skill    for level, ind in level_ind_dct.items():        level_lst[ind] = level    return skill_lst, level_l<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>翻译一下就是先打开<code>/data</code>目录下的<code>skill_level_dict.pkl</code>文件序列解包后赋值给<code> filtered_skill_dct, skill_ind_dct, level_dct, level_ind_dct, tempt_dct, tempt_ind_dct</code>这些变量，遍历列表所有元素并赋值给<code>skill_lst</code>和<code>level_l</code>这两个列表</p><p>接下来就是将上面得到的参数，传入SSCN这个类，实例化得到模型，用模型<code>model</code>来预测结果</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">model = SSCN(n_time, n_city, n_comp, n_industry, n_skill, n_level, n_tempt, n_workyear, dim_city, dim_skill, dim_comp,             comp_featsize, maxlen_skill, feat_time_city, data_comp_feat_val, data_comp_feat_id, data_comp_industry, data_skill_mat, data_skill_feat, data_G, time_reg=1,             fm_embsize=16, dropout_fm_feed=[0.8, 0.8], dim_skill_share=10,dim_skill_own=6,             deep_share=[64, 64, 64], dropout_share_feed=[0.6, 0.6, 0.8, 0.8], l2_reg=0.3,             deep_value=[16, 16, 16], dropout_value_feed=[0.8, 1.0, 1.0, 1.0],             deep_impact=[16, 16, 16], dropout_impact_feed=[1.0, 1.0, 1.0, 1.0],             gcn_layers=[16, 16], dropout_gcn_feed=[1.0, 1.0, 1.0],             activation=tf.nn.leaky_relu, learning_rate=0.001, verbose=1, random_seed=2019, batch_size=256)model.load_model("%s/model_save/SSCN" % SAVE_PATH_NOW)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>最后print输出预测结果</p><h2 id="思维导图和流程图"><a href="#思维导图和流程图" class="headerlink" title="思维导图和流程图"></a>思维导图和流程图</h2><img src="https://gitee.com/wwj1026/image/raw/master/20211209/6IKFzixi6gbS.png" style="zoom: 50%;"><p><img src="https://gitee.com/wwj1026/image/raw/master/20211210/JksyEyPYh8gu.png"></p><h1 id="SSCN-py-没时间，暂未看"><a href="#SSCN-py-没时间，暂未看" class="headerlink" title="SSCN.py(没时间，暂未看)"></a>SSCN.py(没时间，暂未看)</h1>]]></content>
      
      
      <categories>
          
          <category> python </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 深度学习 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>拉勾网爬虫</title>
      <link href="/2021/12/07/la-gou-wang-pa-chong/"/>
      <url>/2021/12/07/la-gou-wang-pa-chong/</url>
      
        <content type="html"><![CDATA[<h1 id="0X01-前言"><a href="#0X01-前言" class="headerlink" title="0X01 前言"></a>0X01 前言</h1><p>​    <strong>因为深度学习训练的需要，需要爬取拉勾网的招聘数据，简单分析了以下，网站没有加密，没有验证码，返回的是json格式，就是封ip,还算是一个简单的爬虫。并且实际抓包时，发现网站实际又两个api接口且都可以使用</strong></p><h1 id="0X02-网页分析"><a href="#0X02-网页分析" class="headerlink" title="0X02 网页分析"></a>0X02 网页分析</h1><p><strong>打开<a href="https://www.lagou.com/">拉勾网</a>，随机输入想要的职业，F12打开开发者工具开始抓包</strong></p><p><strong>我们很容易发现，在切换网页时的一个post请求，点开查看，果然是返回职业信息等数据(并且是json格式的)</strong></p><p><a href="https://gitee.com/wwj1026/image/raw/master/20211207/YbyynaK0d0EM.png"><img src="https://gitee.com/wwj1026/image/raw/master/20211207/YbyynaK0d0EM.png" alt="https://gitee.com/wwj1026/image/raw/master/20211207/YbyynaK0d0EM.png"></a></p><p><strong>查看发送的请求数据</strong></p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">first: trueneedAddtionalResult: falsecity: 全国px: newpn: 2fromSearch: truekd: php<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>很容易猜出来，<code>city</code>是查询的城市，<code>kd</code>是查询的职业名称，<code>pn</code>是网页的页数，其他在查看多次请求发现并没有变化，因此可以保持不变</strong></p><p><strong>接下来就是构造请求数据</strong></p><pre class="line-numbers language-python" data-language="python"><code class="language-python">import requests#请求的URLURL = 'https://www.lagou.com/jobs/v2/positionAjax.json'#构造请求头HEADERS = {        'User-Agent':'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/96.0.4664.55 Safari/537.36 Edg/96.0.1054.43',        'Cookie':'你的cookie',        'Content-Type':'application/x-www-form-urlencoded; charset=UTF-8',        'Referer':'https://www.lagou.com/jobs/list_python%E5%B7%A5%E7%A8%8B%E5%B8%88?labelWords=sug&amp;fromSearch=true&amp;suginput=python',        'traceparent':'00-db0538745383ebdb6466c2bb569a5b96-e9d2459f12b072ab-01'}#构造请求表单DATA = {        'first': 'true',        'pn': 2,        'px':'new',        'kd': 'java',        'fromSearch':'true',        'city':杭州}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>接下来就是简单构造以下POST请求</strong></p><pre class="line-numbers language-python" data-language="python"><code class="language-python">#请求延迟三秒res = requests.post(url=URL,headers=HEADERS,data=DATA,timeout=3)#设置为utf-8编码res.encoding ='utf-8'#解析json数据res_dict = res.json()<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>最后就是数据处理，将json转换成python的字典，取出要爬取的数据</strong></p><pre class="line-numbers language-python" data-language="python"><code class="language-python">postion_num = res_dict['content']['positionResult']['resultSize']    for x in range(1,int(postion_num)):        job_dict = res_dict['content']['positionResult']['result'][x]        position_name = job_dict['positionName']        position_lable=job_dict['positionLables']        company = job_dict['companyFullName']        salary =job_dict['salary']        city =job_dict['city']        work_year = job_dict['workYear']        skill_lable = job_dict['skillLables']        position_detail = job_dict['positionDetail']        job_type = job_dict['firstType']        company_lable_list=job_dict['companyLabelList']        formatCreateTime=job_dict['formatCreateTime']        createTime=job_dict['createTime']        district=job_dict['district']   print(formatCreateTime,city,company,salary,position_name,position_lable,company_lable_list,'\n')<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h1 id="0X03遇到的问题"><a href="#0X03遇到的问题" class="headerlink" title="0X03遇到的问题"></a>0X03遇到的问题</h1><h2 id="lt-1-gt-ip限制"><a href="#lt-1-gt-ip限制" class="headerlink" title="<1>ip限制"></a>&lt;1&gt;ip限制</h2><p><strong>拉勾网对IP限制比较严格，平均一个IP只能爬大概5-6页之后IP就黑了，所以要想愉快地爬虫就得接入代理ip</strong></p><p><strong>我选择的是<a href="http://www.xdaili.cn/usercenter/coupon">讯代理IP</a>，没啥，就是因为便宜且接入简单</strong></p><p><strong>因为讯代理API返回默认是json格式并不能直接使用，需要处理一下</strong></p><pre class="line-numbers language-python" data-language="python"><code class="language-python">def get_ip():    url='api链接'    res=requests.get(url=url)    res_dict = res.json()    print(res_dict)    res_dict=res_dict['RESULT'][0]    ip=res_dict['ip']    port=res_dict['port']    print('正在使用代理ip,当前取到ip为'+result,'\n')    time.sleep(5)   <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>之后在<code>requests.post()</code>参数中添加<code>proxies</code>参数，具体如下</strong></p><pre class="line-numbers language-python" data-language="python"><code class="language-python">proxies ={'http':'','https':''}result='http://'+ip+':'+portproxies['https']=resultproxies['http']=result<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h2 id="lt-2-gt-爬虫报错"><a href="#lt-2-gt-爬虫报错" class="headerlink" title="<2>爬虫报错"></a>&lt;2&gt;爬虫报错</h2><p><strong>开始我是一个for循环遍历，后来发现了一个致命的问题，程序经常报错退出，原因就是代理ip也不是每个都能用，解决办法就是用python的<code>异常捕获</code>,<code>try...expect</code></strong></p><pre class="line-numbers language-python" data-language="python"><code class="language-python">try:    passexpect:    print('代理IP无效！')<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p><strong>这样就可以防止程序因为一个IP不能用而报错弹出</strong></p><h2 id="lt-3-gt-数据储存"><a href="#lt-3-gt-数据储存" class="headerlink" title="<3>数据储存"></a>&lt;3&gt;数据储存</h2><p><strong>还有一个比较致命的问题，爬出来的数据储存在哪里，我的选择是<code>csv文件</code></strong></p><p><strong>具体处理如下</strong></p><pre class="line-numbers language-python" data-language="python"><code class="language-python">import csvwith open('test.csv', mode='w',encoding='utf-8') as csv_file:    fieldnames = ['createTime','district','city']        writer = csv.DictWriter(csv_file, fieldnames=fieldnames)        writer.writeheader()#如果想追加写入，那么把mode='w'改为mode='a'with open('test.csv', mode='a',encoding='utf-8') as csv_file:        fieldnames = ['createTime','city']        writer = csv.DictWriter(csv_file, fieldnames=fieldnames)        writer.writerow({'createTime':createTime,'city': city,'district':district})<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h1 id="0X04总结分析"><a href="#0X04总结分析" class="headerlink" title="0X04总结分析"></a>0X04总结分析</h1><ul><li><strong>总的来说，这个网站还是比较简单的并不需要登录，也不需要处理加密有关的js，也没有验证码限制</strong></li></ul><h1 id="0X05总代码"><a href="#0X05总代码" class="headerlink" title="0X05总代码"></a>0X05总代码</h1><pre class="line-numbers language-python" data-language="python"><code class="language-python"># coding=UTF-8import jsonimport requestsimport time from urllib import parseimport csvPUSH_TOKEN='92aeca72fb934d08b2fffdeda07eb82d'proxies ={'http':'','https':''}def get_ip():    url='http://api.xdaili.cn/xdaili-api//greatRecharge/getGreatIp?spiderId=afd29f9005e24269a691ac70c45ae49b&amp;orderno=YZ20211272784EmDNve&amp;returnType=2&amp;count=1'    res=requests.get(url=url)    res_dict = res.json()    print(res_dict)    res_dict=res_dict['RESULT'][0]    ip=res_dict['ip']    port=res_dict['port']    result='http://'+ip+':'+port    proxies['https']=result    proxies['http']=result    print('正在使用代理ip,当前取到ip为'+result,'\n')    time.sleep(5)   def lagou(url,cookies,pn):    a=str(time.time())    # a=str(time.strftime("%Y-%m-%d %H:%M:%S", time.localtime()))    with open(inquire_city+a+'.csv', mode='w',encoding='utf-8') as csv_file:        fieldnames = ['createTime','district','city', 'companyFullName', 'position_name','workYear','salary','positionLable','CompanyLableList']        writer = csv.DictWriter(csv_file, fieldnames=fieldnames)        writer.writeheader()                for num in range(1,int(pn)+1):        print('正在抓取第'+str(num)+'页数据，请稍后……','\n')        headers = {        'User-Agent':'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/15.1 Safari/605.1.15',        'Cookie':cookies,        'Content-Type':'application/x-www-form-urlencoded; charset=UTF-8',        'Referer':'https://www.lagou.com/jobs/list_python%E5%B7%A5%E7%A8%8B%E5%B8%88?labelWords=sug&amp;fromSearch=true&amp;suginput=python',        'traceparent':'00-e9b75151ed181093b73c50d31e63257c-a6c8119a30d5a87a-01'        }        data= {        'MIME Type': 'application/x-www-form-urlencoded; charset=UTF-8',        'first': 'false',        'pn': str(num),        'kd': 'python工程师',        'sid': 'f5c3889438be4550bf48428f2edd229c'        }        try:            res = requests.post(url=url,proxies=proxies,headers=headers,data=data,timeout=3)            res.encoding='utf-8'            res_dict = res.json()            print(res_dict)                # postion_num = content['positionResult']['resultSize']            postion_num = res_dict['content']['positionResult']['resultSize']                            for x in range(1,int(postion_num)):                job_dict = res_dict['content']['positionResult']['result'][x]                position_name = job_dict['positionName']                position_lable=job_dict['positionLables']                company = job_dict['companyFullName']                salary =job_dict['salary']                city =job_dict['city']                work_year = job_dict['workYear']                skill_lable = job_dict['skillLables']                position_detail = job_dict['positionDetail']                job_type = job_dict['firstType']                company_lable_list=job_dict['companyLabelList']                formatCreateTime=job_dict['formatCreateTime']                createTime=job_dict['createTime']                district=job_dict['district']                print(formatCreateTime,city,company,salary,position_name,position_lable,company_lable_list,'\n')                with open(inquire_city+a+'.csv', mode='a',encoding='utf-8') as csv_file:                    fieldnames = ['createTime','city','district', 'companyFullName','position_name', 'workYear','salary','positionLable','CompanyLableList']                    writer = csv.DictWriter(csv_file, fieldnames=fieldnames)                    writer.writerow({'createTime':createTime,'city': city,'district':district, 'companyFullName': company, 'position_name':position_name,'workYear':work_year,'salary': salary,'positionLable':position_lable,'CompanyLableList':company_lable_list})                time.sleep(1)                if num == int(pn):                    print('爬取城市'+inquire_city+'完成！','\n')                    push()                else:                    print('抓取第'+str(num)+'页数据完毕，反爬虫延迟10秒，请稍后……','\n')                time.sleep(10)        except:            print('ip不可用……','')            get_ip()                    def push():    token = PUSH_TOKEN    title= '爬虫小助手提示您'     content ='爬取城市'+inquire_city+'完成！'    url = 'http://pushplus.hxtrip.com/send'    data = {    "token":token,    "title":title,    "content":content,    "template":"html"    }    body=json.dumps(data).encode(encoding='utf-8')    headers = {'Content-Type':'application/json'}    requests.post(url,data=body,headers=headers)    print('发送成功')if __name__ == '__main__':    # pn = input('请输入需要抓取的页面数量\n')    pn = 5 #默认全爬了    global inquire    for inquire_city in ['成都','北京','上海','深圳','广州','杭州','成都','南京','武汉','西安','厦门','长沙','苏州','天津']:        # inquire_city = input('请输入要抓取的城市\n')        print('当前正在爬取：'+inquire_city,'\n')        url = 'https://www.lagou.com/jobs/positionAjax.json?city='+parse.quote(str(inquire_city))+'&amp;needAddtionalResult=false'        #cookies会失效，但是时间未知，爬取失败就是失效了        #拉钩网对IP有限制，不要爬虫太频繁，IP会黑        cookies='user_trace_token=20211206152508-622b35b2-5973-44ae-8dbd-c9063983155c; _ga=GA1.2.839399246.1638775509; LGUID=20211206152510-a6a6e2e9-b124-4398-9fe5-f547632f442d; _gid=GA1.2.1191253379.1638775513; sajssdk_2015_cross_new_user=1; RECOMMEND_TIP=true; privacyPolicyPopup=false; index_location_city=%E5%85%A8%E5%9B%BD; __lg_stoken__=b2b39cddc7239cca8b78ede679593016021997d45ffbdbc9ebf16167c154583ef2ee6cae87f0ad07ed789ea12a430fb68e08b72605a62ffbd94663ad326f3b676d094c764ba6; SEARCH_ID=7fcfd8bbd7604664b4bd13e5f57b55b3; sm_auth_id=11mb0eofylc8pj90; X_HTTP_TOKEN=f93af4318e865df41766978361b9921f316e3a2576; Hm_lpvt_4233e74dff0ae5bd0a3d81c6ccf756e6=1638796672; Hm_lvt_4233e74dff0ae5bd0a3d81c6ccf756e6=1638775513,1638775518,1638775551,1638796672; LGSID=20211206211751-8fbbcde0-a269-4c50-959f-4ba08bf42dbf; PRE_UTM=; PRE_HOST=; PRE_SITE=; PRE_LAND=https%3A%2F%2Fs.lagou.com%2F; LGRID=20211206211751-5e384ce2-d6ae-46e7-af68-3bba1f7f8d18; WEBTJ-ID=20211206211757-17d8fe4d228b9d-0e21df1e5607e1-978183a-1024000-17d8fe4d229c5f; JSESSIONID=ABAAAECABIEACCAE23819A5BAEAC62FA9105E5795953C2F; sensorsdata2015session=%7B%7D; sensorsdata2015jssdkcross=%7B%22distinct_id%22%3A%2217d8ea1e04559-071bcb5a344034-978183a-1024000-17d8ea1e046655%22%2C%22%24device_id%22%3A%2217d8ea1e04559-071bcb5a344034-978183a-1024000-17d8ea1e046655%22%2C%22props%22%3A%7B%22%24latest_traffic_source_type%22%3A%22%E7%9B%B4%E6%8E%A5%E6%B5%81%E9%87%8F%22%2C%22%24latest_referrer%22%3A%22%22%2C%22%24latest_search_keyword%22%3A%22%E6%9C%AA%E5%8F%96%E5%88%B0%E5%80%BC_%E7%9B%B4%E6%8E%A5%E6%89%93%E5%BC%80%22%2C%22%24os%22%3A%22Windows%22%2C%22%24browser%22%3A%22Chrome%22%2C%22%24browser_version%22%3A%2296.0.4664.45%22%7D%7D'        get_ip()        lagou(url,cookies,pn)# print(job_dict)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> python </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 爬虫 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>从0开始用flask写后端api接口</title>
      <link href="/2021/12/05/cong-0-kai-shi-yong-flask-xie-hou-duan-api-jie-kou/"/>
      <url>/2021/12/05/cong-0-kai-shi-yong-flask-xie-hou-duan-api-jie-kou/</url>
      
        <content type="html"><![CDATA[<pre class="line-numbers language-python" data-language="python"><code class="language-python">from flask import Flask, requestimport jsonimport requests app = Flask(__name__)  # 只接受POST方法访问@app.route("/api",methods=["POST"])def check():    # 默认返回内容    return_dict = {'statusCode': '200', 'message': 'successful!', 'result': False}    # 判断入参是否为空    if request.get_data() is None:        return_dict['statusCode'] = '5004'        return_dict['message'] = '请求参数为空'        return json.dumps(return_dict, ensure_ascii=False)     get_data = request.get_data()  # 获取传入的参数    get_data = json.loads(get_data)  # 传入的参数为bytes类型，需要转化成json    name = get_data.get('name')    psswd = get_data.get('psswd')     return_dict['result'] = tt(name, psswd)  # 对参数进行操作    return json.dumps(return_dict, ensure_ascii=False)  # 功能函数def tt(name, psswd):    LOGIN_URL = 'https://nco.zjgsu.edu.cn/login'    SUBMIT_URL='https://nco.zjgsu.edu.cn/'    LOGIN_HEADER={    "User-Agent":"Mozilla/5.0 (iPhone; CPU iPhone OS 13_2_3 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/13.0.3 Mobile/15E148 Safari/604.1 Edg/93.0.4577.82",    'Content-Type': 'application/x-www-form-urlencoded'    }    LOGIN_BODY={    "name":name,    "psswd":psswd    }    SUBMIT_BODY={        'uuid':'a59e0ac8-da06-4fb1-83d8-000976c317a9',        'locationInfo': '浙江省',        'currentResd': '浙江省杭州市江干区浙江工商大学钱江湾生活园区',        'fromHbToZjDate': '',        'fromHbToZj': 'C',        'fromWtToHzDate': '',        'fromWtToHz': 'B',        'meetDate': '',        'meetCase': 'C',        'travelDate': '',        'travelCase': 'D',        'medObsvReason': '',        'medObsv': 'B',        'belowCaseDesc': '',        'belowCase': 'D',        'temperature': '',        'notApplyReason': '',        'hzQRCode': 'A',        'specialDesc': ''    }    response=requests.post(url=LOGIN_URL,headers=LOGIN_HEADER,data=LOGIN_BODY)    cookies = response.cookies    submit_response=requests.post(SUBMIT_URL,headers=LOGIN_HEADER,cookies=cookies,data=SUBMIT_BODY)    submit_response_str=submit_response.text    if '报送成功' in submit_response_str:        result_str = '填报成功啦'    # elif '当天只能申报一次'in submit_response_str:    #     result_str = '当天已填报'    # # result_str = "返回cookie为%s" % (cookies)    # elif '未填报' in submit_response_str:    #     result_str = '当天未填报'    else:        result_str = '出现错误啦'    return result_str if __name__ == "__main__":    app.run(host='0.0.0.0',debug=True)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> python </category>
          
      </categories>
      
      
        <tags>
            
            <tag> flask </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>微软云申请</title>
      <link href="/2021/12/05/wei-ruan-yun-shen-qing/"/>
      <url>/2021/12/05/wei-ruan-yun-shen-qing/</url>
      
        <content type="html"><![CDATA[<h1 id="申请连接"><a href="#申请连接" class="headerlink" title="申请连接"></a>申请连接</h1><p><strong><a href="http://signup.azure.com/studentverification?offerType=1">微软云申请入口</a></strong></p><h1 id="余额查询入口"><a href="#余额查询入口" class="headerlink" title="余额查询入口"></a>余额查询入口</h1><p><strong><a href="https://www.microsoftazuresponsorships.com/Balance">余额查询入口</a></strong></p>]]></content>
      
      
      <categories>
          
          <category> vps </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Azure </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>青龙面板</title>
      <link href="/2021/12/05/qing-long-mian-ban/"/>
      <url>/2021/12/05/qing-long-mian-ban/</url>
      
        <content type="html"><![CDATA[<h2 id="安装Docker"><a href="#安装Docker" class="headerlink" title="安装Docker"></a>安装Docker</h2><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">apt update -y &amp;&amp; apt install -y curl &amp;&amp; apt install -y socat#更新curl -fsSL https://get.docker.com -o get-docker.shsh get-docker.sh#安装Docker<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="启动青龙面板"><a href="#启动青龙面板" class="headerlink" title="启动青龙面板"></a>启动青龙面板</h2><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">docker run -dit \-v $PWD/ql/config:/ql/config \-v $PWD/ql/log:/ql/log \-v $PWD/ql/db:/ql/db \-p 5700:5700 \--name qinglong  \--hostname qinglong \--restart always \whyour/qinglong:latest<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> vps </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 青龙面板 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>nextcloud云盘安装</title>
      <link href="/2021/12/05/nextcloud-yun-pan-an-zhuang/"/>
      <url>/2021/12/05/nextcloud-yun-pan-an-zhuang/</url>
      
        <content type="html"><![CDATA[<h2 id="什么是snap"><a href="#什么是snap" class="headerlink" title="什么是snap"></a>什么是snap</h2><p><strong><code>Snap</code>的安装包扩展名是<code>.snap</code>，类似于一个容器，完全独立于系统，它包含一个应用程序需要用到的所有文件和库（<code>snap</code>包包含一个私有的<code>root</code>文件系统，里面包含了依赖的软件包）。它们会被安装到单独的目录，各个应用程序之间相互隔离，互不影响。而且安装快捷、创建简单、运行安全，易管理。目前支持的主流发行版有<code>Ubuntu</code>、<code>Debian</code>等。</strong></p><p><strong>文章基于snap安装Nextcloud，docker也是可以的</strong></p><p><strong>以下是snap的用法</strong></p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">#查看snap版本信息snap --version#找出所有snap应用snap find#安装应用snap install 包名#重启应用snap restart 应用名#升级应用snap refresh 应用名#查看安装的应用snap list#卸载应用snap remove 应用名<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><p><strong>由于<code>Ubuntu 16.04</code>系统自带<code>Snap</code>，为了方便，可以直接使用该系统。<code>Snap</code>包自带<code>NextCloud</code>，所以我们可以直接安装</strong></p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">#更新系统apt-get update -y#安装NextCloudsnap install nextcloud<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p><strong>这时候就可以打开<code>http://your_ip</code>进入登录页面了，如果想用域名登录并配置<code>SSL</code>证书的话，先别登录，请直接看后面。</strong></p><h2 id="配置域名"><a href="#配置域名" class="headerlink" title="配置域名"></a>配置域名</h2><p><strong>将域名解析至<code>VPS</code>的<code>IP</code>就可以使用域名登录了，然后再添加<code> Let’s encrypt SSL</code>证书并使用<code>https</code>访问。</strong></p><h2 id="添加SSL证书"><a href="#添加SSL证书" class="headerlink" title="添加SSL证书"></a>添加SSL证书</h2><p><strong>使用命令：</strong></p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">nextcloud.enable-https lets-encrypt<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong>根据要求输入你的邮箱，域名即可！然后就可以打开域名并设置账号和密码登录了。</strong></p><h2 id="可能遇到的问题"><a href="#可能遇到的问题" class="headerlink" title="可能遇到的问题"></a>可能遇到的问题</h2><p><strong>先等域名解析完成后再申请SSL证书</strong></p><p><strong>提示不安全连接的解决方案</strong></p><p><strong>打开nextcloud目录下的config.php文件，我的地址为var/snap/nextcloud/28654/nextcloud/config/</strong></p><p><strong>在trusted_domains数组中添加你的服务器ip和对应域名</strong></p><p><strong>并且在数组后加上</strong></p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">'overwritehost' =&gt; '你的域名','overwriteprotocol' =&gt; 'https'<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><ul><li><a href="https://www.moerats.com/archives/429/">Snap下安装nextcloud</a></li><li><a href="https://www.cnblogs.com/mouseleo/p/15516828.html">NextCloud 使用https反向代理后PC端异常</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> vps </category>
          
      </categories>
      
      
        <tags>
            
            <tag> nextcloud </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>x-ui面板</title>
      <link href="/2021/12/05/x-ui-mian-ban/"/>
      <url>/2021/12/05/x-ui-mian-ban/</url>
      
        <content type="html"><![CDATA[<h1 id="vps搭建x-ui面板（基于ubuntu-18-04）"><a href="#vps搭建x-ui面板（基于ubuntu-18-04）" class="headerlink" title="vps搭建x-ui面板（基于ubuntu 18.04）"></a>vps搭建x-ui面板（基于ubuntu 18.04）</h1><h2 id="First"><a href="#First" class="headerlink" title="First"></a>First</h2><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">apt update -y &amp;&amp; apt install -y curl &amp;&amp; apt install -y socat<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="Second"><a href="#Second" class="headerlink" title="Second"></a>Second</h2><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">wget--no-check-certificate-q-0bbr2.sh"https://github.com/yeyingorg/bbr2.sh/raw/master/bbr2.sh" &amp;&amp; chmod +x bbr2.sh &amp;&amp; bash bbr2.sh auto<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><strong>开启BBR加速</strong></p><h2 id="Third"><a href="#Third" class="headerlink" title="Third"></a>Third</h2><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">bash &lt;(curl -L https://raw.githubusercontent.com/vaxilu/x-ui/master/install.sh)<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong>一键安装脚本</strong></p><h2 id="注意事项"><a href="#注意事项" class="headerlink" title="注意事项"></a>注意事项</h2><ul><li><strong>x-ui面板默认占用54321端口，端口必须开放</strong></li></ul>]]></content>
      
      
      <categories>
          
          <category> vps </category>
          
      </categories>
      
      
        <tags>
            
            <tag> v2ray </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>vps搭建shadowsocks</title>
      <link href="/2021/11/24/shadowsocks/"/>
      <url>/2021/11/24/shadowsocks/</url>
      
        <content type="html"><![CDATA[<h2 id="Fisrt"><a href="#Fisrt" class="headerlink" title="Fisrt"></a>Fisrt</h2><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">apt -y install snapd#安装snapsnap install coresnap install shadowsocks-libev#snap安装shadowsocks<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="Second"><a href="#Second" class="headerlink" title="Second"></a>Second</h2><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">vim /etc/ssh/sshd_configand find the word "#PermitRootLogin Prohibit-password"add PermitRootLogin yes below itrestar ssh serverservice sshd restart#or/etc/init.d/ssh restart<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="Third"><a href="#Third" class="headerlink" title="Third"></a>Third</h2><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">add config.json{ "server":"0.0.0.0", "nameserver":"8.8.8.8", "server_port":443, "password":"lj010627", "method":"chacha20-ietf-poly1305", "timeout":600, "no_delay":true, "mode":"tcp_and_udp"}star server/snap/bin/shadowsocks-libev.ss-server -c /snap/shadowsocks-libev/config.json -f /snap/bin/ss-server-pid<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="Fourth"><a href="#Fourth" class="headerlink" title="Fourth"></a>Fourth</h2><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">confirm server stared or notnetstat -l<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h2 id="Fifth"><a href="#Fifth" class="headerlink" title="Fifth"></a>Fifth</h2><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">check the speedwget -qO- git.io/superbench.sh | bash<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h2 id="可能遇到的问题"><a href="#可能遇到的问题" class="headerlink" title="可能遇到的问题"></a>可能遇到的问题</h2><p><strong>获取root用户权限登录</strong></p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">## 先获取root权限sudo -i## vim修改配置vim /etc/ssh/sshd_config<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p><strong>找到</strong></p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">#PermitRootLogin Prohibit-password #<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong>修改为</strong></p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">PermitRootLogin yes<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong>重启ssh服务</strong></p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">service sshd restart#或/etc/init.d/ssh restart<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p><strong>更改密码</strong></p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">sudo passwd root#会显示如下 按要求更改后重启ssh服务[sudo] password for kerwin: #输入当前用户密码New password: #输入root新密码Retype new password: #再次输入root密码passwd: password updated successfully #密码更新成功<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>用root账户登录</strong></p>]]></content>
      
      
      <categories>
          
          <category> vps </category>
          
      </categories>
      
      
        <tags>
            
            <tag> shadowsocks </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>前端全栈学习</title>
      <link href="/2021/11/04/qian-duan-quan-zhan-xue-xi/"/>
      <url>/2021/11/04/qian-duan-quan-zhan-xue-xi/</url>
      
        <content type="html"><![CDATA[<h1 id="学习日记"><a href="#学习日记" class="headerlink" title="学习日记"></a>学习日记</h1><h2 id="2021-11-04"><a href="#2021-11-04" class="headerlink" title="2021-11-04"></a>2021-11-04</h2><ul><li><strong>配置开发工具-vscode</strong></li><li><strong>安装Sublime插件</strong></li><li><strong>安装live server插件</strong></li></ul><pre class="line-numbers language-html" data-language="html"><code class="language-html">ctrl+shift+d 复制当前行ctrl+shift+↑ 上移当前行ctrl+shift+↓ 下移当前行按住鼠标滚轮向下滑动可以多行编辑<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h3 id="html5骨架"><a href="#html5骨架" class="headerlink" title="html5骨架"></a>html5骨架</h3><ul><li>第一行必须是DTD(Document Type Definition,文档类型声明)</li><li>不写会导致浏览器兼容问题</li><li>标准制定机构-W3C(The World Wide Web Consortium,万维网联合会，成立于1994，负责Html和Css标准指定)</li></ul><pre class="line-numbers language-html" data-language="html"><code class="language-html"><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>en<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>UTF-8<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">http-equiv</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>X-UA-Compatible<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>IE=edge<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>viewport<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>width=device-width, initial-scale=1.0<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>Document<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>head标签对是对网页的配置项</li><li></li></ul>]]></content>
      
      
      <categories>
          
          <category> html5 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> coding </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>腾讯云函数玩法</title>
      <link href="/2021/09/27/yun-han-shu-wan-fa/"/>
      <url>/2021/09/27/yun-han-shu-wan-fa/</url>
      
        <content type="html"><![CDATA[<h1 id="脚本合集"><a href="#脚本合集" class="headerlink" title="脚本合集"></a>脚本合集</h1><h2 id="项目1-监控教务网公告"><a href="#项目1-监控教务网公告" class="headerlink" title="项目1(监控教务网公告)"></a>项目1(监控教务网公告)</h2><ul><li>每小时监控是否有新的新闻发布，如果有将通过pushplus推送</li></ul><h3 id="云函数代码"><a href="#云函数代码" class="headerlink" title="云函数代码"></a>云函数代码</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python">import requestsimport reimport datetimeimport jsonREQUEST_URL = 'https://jww.zjgsu.edu.cn/1319/list.htm'REQUEST_HEADER={    'user-agent':'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/94.0.4606.61 Safari/537.36 Edg/94.0.992.31',    'accept':'text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9',    'cache-control':'zh-CN,zh;q=0.9,en;q=0.8,en-GB;q=0.7,en-US;q=0.6'}log=[]PUSH_TOKEN="你的token"#你的tokennews_pattern = r'li class="column-news-item item.*?&gt;(.*?)&lt;/li&gt;' #匹配所有新闻new_pattern = r'&lt;a .*?&gt;(.*?)&lt;/a&gt;' #匹配文本date_pattern = r'&lt;span class="column-news-date news-date.*?&gt;(.*?)&lt;/span&gt;'#匹配日期#link_pattern=r'href="(.*?)"'#匹配网址def get_news():    response = requests.get(url=REQUEST_URL,headers=REQUEST_HEADER)    response.encoding='utf-8'    total_news = re.findall(news_pattern, response.text, re.S | re.M)    now_time = datetime.datetime.now().strftime('%Y-%m-%d')    for content in total_news:        news = re.findall(new_pattern, content, re.S | re.M)        date = re.findall(date_pattern, content, re.S | re.M)#       link=re.findall(link_pattern,content,re.I | re.S | re.M)        if date[0] == now_time:           log.append(news[0]+"|"+date[0])           print("任务完成")           push()def push():    token = PUSH_TOKEN    title= '主人，发现一条新的教务网新闻'     content =log    url = 'http://pushplus.hxtrip.com/send'    data = {    "token":token,    "title":title,    "content":content,    "template":"html"    }    body=json.dumps(data).encode(encoding='utf-8')    headers = {'Content-Type':'application/json'}    requests.post(url,data=body,headers=headers)    print('发送成功')def main_handler(event, context):    get_news()if __name__=='__main__':    get_news()#total_news=re.findall('&lt;ul&gt;(.*?)&lt;div id="wp_paging_w9"&gt;',response.text,re.I | re.S | re.M)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="项目2-超星作业监控"><a href="#项目2-超星作业监控" class="headerlink" title="项目2(超星作业监控)"></a>项目2(超星作业监控)</h2><h3 id="云函数代码-1"><a href="#云函数代码-1" class="headerlink" title="云函数代码"></a>云函数代码</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python">import requestsimport reimport jsonREQUEST_URL='https://mooc1.chaoxing.com/mooc2/work/list?courseId=219653330&amp;classId=44557992&amp;cpi=148310557&amp;enc=f6c483c0cffe260125bd505724007a28'REQUEST_HEADER={    'User-Agent':'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/93.0.4577.82 Safari/537.36',    'cookie':""}PUSH_TOKEN=""homework_pattern="&lt;ul&gt;(.*?)&lt;/ul&gt;"title_pattern=r'&lt;p class="overHi.*?&gt;(.*?)&lt;/p&gt;'status_pattern=r'&lt;p class="status"&gt;(.*?)&lt;/p&gt;'deadline_pattern=r'&lt;img class.*?&gt;(.*?)&lt;/div&gt;'response=requests.get(url=REQUEST_URL,headers=REQUEST_HEADER)response.encoding='utf-8'#res=re.findall(homework_pattern,response.text,re.S | re.M)log=[]def inquiries_homework():    single_homework=re.findall(title_pattern,response.text,re.S | re.M)    single_status=re.findall(status_pattern,response.text, re.M |re.S)    single_deadline=re.findall(deadline_pattern,response.text,re.S | re.M)    for i in single_status:        if i == '未交':            num=single_status.index(i)            homework=single_homework[num]            status=single_status[num]            deadline=single_deadline[num]            log.append("作业名称：**"+homework.strip()+"**剩余时间：**"+deadline.strip()+"**当前状态："+status.strip())            print(log)            push()    # for i in single_deadline:    #     if i != '':    #         num=single_deadline.index(i)    #         homework=single_homework[num]    #         status=single_status[num]    #         deadline=i.strip()    #         log.append("作业名称：**"+homework.strip()+"**剩余时间：**"+deadline+"**当前状态："+status.strip())    #         push()def push():    token = PUSH_TOKEN    title= '主人，您在超星学习通还有份数学作业未完成，请尽快完成！'     content =log    url = 'http://pushplus.hxtrip.com/send'    data = {    "token":token,    "title":title,    "content":content,    "template":"html"    }    body=json.dumps(data).encode(encoding='utf-8')    headers = {'Content-Type':'application/json'}    requests.post(url,data=body,headers=headers)    print('发送成功')def main_handler(event, context):    inquiries_homework()if __name__=='__main__':    inquiries_homework()<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> python </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 云函数 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>重构C语言</title>
      <link href="/2021/09/22/chong-gou-c-yu-yan/"/>
      <url>/2021/09/22/chong-gou-c-yu-yan/</url>
      
        <content type="html"><![CDATA[<h1 id="重构C语言体系"><a href="#重构C语言体系" class="headerlink" title="重构C语言体系"></a>重构C语言体系</h1><h2 id="C语言必备基础"><a href="#C语言必备基础" class="headerlink" title="C语言必备基础"></a>C语言必备基础</h2><ul><li>环境搭建-略</li><li>使用开发工具，CLion</li><li>配置CLion,代码风格选择谷歌，编译器创建三个vs-64,vs-32,MINGW,debug两个vs-64,MINGW</li></ul><p><strong>编写第一行代码</strong></p><pre class="line-numbers language-c" data-language="c"><code class="language-c">#include &lt;stdio.h&gt;/** * This program calculate summary from 0 to 9. * @param argc parameter count * @param argv parameters * @return 0 */int main(int argc,char **argv) {  int sum = 0;  int i = 0;  while (i &lt;10){    sum = sum +i;    i++;  }  printf("%d\n",sum);  return 0;}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>​    </p>]]></content>
      
      
      <categories>
          
          <category> c language </category>
          
      </categories>
      
      
        <tags>
            
            <tag> coding </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Python爬虫日常</title>
      <link href="/2021/09/12/python-pa-chong/"/>
      <url>/2021/09/12/python-pa-chong/</url>
      
        <content type="html"><![CDATA[<h1 id="目录"><a href="#目录" class="headerlink" title="目录"></a>目录</h1><h2 id="记录自己从零学习Python爬虫"><a href="#记录自己从零学习Python爬虫" class="headerlink" title="记录自己从零学习Python爬虫"></a>记录自己从零学习Python爬虫</h2><h2 id="学习进度"><a href="#学习进度" class="headerlink" title="学习进度"></a>学习进度</h2><ul><li><strong>2021.9.19 第五章变量与运算符</strong></li><li><strong>2021.9.20第九章面向对象</strong></li><li><strong>2021.9.21第十章正则表达式与json</strong></li><li><strong>2021.9.22第十三章原生爬虫</strong></li></ul><h2 id="基本数据类型"><a href="#基本数据类型" class="headerlink" title="基本数据类型"></a>基本数据类型</h2><p><strong>数字整型，浮点</strong></p><ul><li><p>python number数据类型包含整型(int)和浮点型(float),float不区分单双精度，默认为双精度</p></li><li><p>查看输入的数据类型，用函数type()</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">&gt;&gt;&gt; type(1)&lt;class 'int'&gt;&gt;&gt;&gt; type(1*1.0)&lt;class 'float'&gt;&gt;&gt;&gt; type(1/1)&lt;class 'float'&gt;&gt;&gt;&gt; type(1//2)&lt;class 'int'&gt;&gt;&gt;&gt; <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li><li><p>python 乘法用* 除法用/(除法返回为float)  强制转换为返回整型除法(int)用//</p></li></ul><p> <strong>各进制之间的表示与转换</strong></p><ul><li><p>python 表示二进制在前面加上特殊标识符<strong>0b</strong> 例如<strong>0b10</strong></p></li><li><p>表示八进制的特殊符号为<strong>0o</strong>例如<strong>0o10</strong></p></li><li><p>表示十六进制的特殊符号为<strong>0x</strong>例如<strong>0x10</strong></p></li><li><p>强制进制转换二进制为bin(),八进制为oct(),十进制int(),十六进制为()</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">Python 3.9.2 (tags/v3.9.2:1a79785, Feb 19 2021, 13:44:55) [MSC v.1928 64 bit (AMD64)] on win32Type "help", "copyright", "credits" or "license()" for more information.&gt;&gt;&gt; 0b102&gt;&gt;&gt; 0b113&gt;&gt;&gt; 0o108&gt;&gt;&gt; 0o119&gt;&gt;&gt; 0x1016&gt;&gt;&gt; 0x1F31&gt;&gt;&gt; bin(10)'0b1010'&gt;&gt;&gt; bin(0xE)'0b1110'&gt;&gt;&gt; bin(0o7)'0b111'&gt;&gt;&gt; int(0b111)7&gt;&gt;&gt; int(0o77)63&gt;&gt;&gt; hex(888)'0x378'&gt;&gt;&gt; hex(0b111)'0x7'&gt;&gt;&gt; oct(0b111)'0o7'&gt;&gt;&gt; <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li></ul><p><strong>布尔类型</strong></p><ul><li>布尔类型也属于number</li><li>0表示False,1表示True</li><li>大多数情况下，非空即为True,空即为False</li><li>强制转换为bool类型，用方法bool()</li></ul><pre class="line-numbers language-python" data-language="python"><code class="language-python">Python 3.9.2 (tags/v3.9.2:1a79785, Feb 19 2021, 13:44:55) [MSC v.1928 64 bit (AMD64)] on win32Type "help", "copyright", "credits" or "license()" for more information.&gt;&gt;&gt; bool(1)True&gt;&gt;&gt; bool(0)False&gt;&gt;&gt; bool("ni")True&gt;&gt;&gt; bool("")False&gt;&gt;&gt; bool(None)False&gt;&gt;&gt; bool([])False&gt;&gt;&gt; bool([1])True&gt;&gt;&gt; bool({})False&gt;&gt;&gt; bool({1,1})True&gt;&gt;&gt; <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>复数</strong></p><ul><li>python表示复数用字母j,例如36j</li></ul><p><strong>字符串单双引号</strong></p><ul><li><p>python表示字符串可以用英文的“ ”，或者英文的‘ ’，单双引号必须成对出现</p></li><li><p>在表示例如Let’s go 这句话时，可以用两种方法</p></li></ul><pre class="line-numbers language-python" data-language="python"><code class="language-python">Python 3.9.2 (tags/v3.9.2:1a79785, Feb 19 2021, 13:44:55) [MSC v.1928 64 bit (AMD64)] on win32Type "help", "copyright", "credits" or "license()" for more information.&gt;&gt;&gt; "Let's go""Let's go"&gt;&gt;&gt; 'Let\'s go'"Let's go"&gt;&gt;&gt; type("A")&lt;class 'str'&gt;&gt;&gt;&gt; str(1)'1'&gt;&gt;&gt; <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>强制转换成字符串类型可以用方法<strong>str()</strong></li></ul><p><strong>多行字符串</strong></p><ul><li>多行字符串用””” “””三引号包含，三引号在IDLE中可以实现回车换行，单引号需要转义字符\，三引号不用单独成行</li></ul><pre class="line-numbers language-python" data-language="python"><code class="language-python">Python 3.9.2 (tags/v3.9.2:1a79785, Feb 19 2021, 13:44:55) [MSC v.1928 64 bit (AMD64)] on win32Type "help", "copyright", "credits" or "license()" for more information.&gt;&gt;&gt; """你好啊你好啊你好啊"""'\n你好啊\n你好啊\n你好啊\n'&gt;&gt;&gt; 'nihao\nihao''nihaonihao'&gt;&gt;&gt; <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>转义字符</strong></p><ul><li>\n换行符 \t横向制表符 \r回车</li><li>\r 和\n不是一个东西，有细微区别</li></ul><p>问题:输入”hello \n world”并且\n被当成字符串输出，有两种解决方案</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">Python 3.9.2 (tags/v3.9.2:1a79785, Feb 19 2021, 13:44:55) [MSC v.1928 64 bit (AMD64)] on win32Type "help", "copyright", "credits" or "license()" for more information.&gt;&gt;&gt; print("hello \n world")hello  world&gt;&gt;&gt; print("hello \\nworld")hello \nworld&gt;&gt;&gt; print(r"hello \nworld")hello \nworld&gt;&gt;&gt; <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>print()函数在输出字符串前<strong>加r</strong>会把后面字符串当作原始字符串输出</li></ul><p><strong>字符串的运算</strong></p><ul><li>字符串可以用+号相加</li><li>字符串可以乘以数字得到多个相同字符串</li><li>取出字符串某个字母在字符串后加入[]</li><li>[]中的序号从0开始，可以为负数，复数为从末尾往前数</li></ul><pre class="line-numbers language-python" data-language="python"><code class="language-python">Python 3.9.2 (tags/v3.9.2:1a79785, Feb 19 2021, 13:44:55) [MSC v.1928 64 bit (AMD64)] on win32Type "help", "copyright", "credits" or "license()" for more information.&gt;&gt;&gt; "hello"+"world"'helloworld'&gt;&gt;&gt; "hello"*3'hellohellohello'&gt;&gt;&gt; "hello world"[1]'e'&gt;&gt;&gt; "hello world"[6]'w'&gt;&gt;&gt; "hello world"[-5]'w'&gt;&gt;&gt; <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>截取”hello world“中的world的方法</li></ul><pre class="line-numbers language-python" data-language="python"><code class="language-python">Python 3.9.2 (tags/v3.9.2:1a79785, Feb 19 2021, 13:44:55) [MSC v.1928 64 bit (AMD64)] on win32Type "help", "copyright", "credits" or "license()" for more information.&gt;&gt;&gt; "hello world"[6:11]'world'&gt;&gt;&gt; "hello world"[6:]'world'&gt;&gt;&gt; "hello world"[6:-1]'worl'&gt;&gt;&gt; "hello world"[-6:]' world'&gt;&gt;&gt; <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>在字符串后加入**[:]**可以取出字符串的某个片段</li></ul><p><strong>列表</strong></p><ul><li>以[]包含的就是列表</li><li>访问列表的某个元素在列表后再加入一个[],操作和字符串相同</li><li>列表可以乘以数字，可以相加</li></ul><pre class="line-numbers language-python" data-language="python"><code class="language-python">Python 3.9.2 (tags/v3.9.2:1a79785, Feb 19 2021, 13:44:55) [MSC v.1928 64 bit (AMD64)] on win32Type "help", "copyright", "credits" or "license()" for more information.&gt;&gt;&gt; ["Q","W","E","R"]['Q', 'W', 'E', 'R']&gt;&gt;&gt; type(["Q","W","E","R"])&lt;class 'list'&gt;&gt;&gt;&gt; ["Q","W","E","R"][1]'W'&gt;&gt;&gt; ["Q","W","E","R"][0:3]['Q', 'W', 'E']&gt;&gt;&gt; ["Q","W","E","R"]+["D"+"F"]['Q', 'W', 'E', 'R', 'DF']&gt;&gt;&gt; ["Q","W","E","R"]+["D","F"]['Q', 'W', 'E', 'R', 'D', 'F']&gt;&gt;&gt; ["Q","W","E","R"]*2['Q', 'W', 'E', 'R', 'Q', 'W', 'E', 'R']&gt;&gt;&gt; <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>元组</strong></p><ul><li>以()容纳的就是元组，元组的操作和列表字符串一致</li></ul><pre class="line-numbers language-python" data-language="python"><code class="language-python">Python 3.9.2 (tags/v3.9.2:1a79785, Feb 19 2021, 13:44:55) [MSC v.1928 64 bit (AMD64)] on win32Type "help", "copyright", "credits" or "license()" for more information.&gt;&gt;&gt; (1,2,3,4)(1, 2, 3, 4)&gt;&gt;&gt; type((1,2))&lt;class 'tuple'&gt;&gt;&gt;&gt; (1,2,3)[1:2](2,)&gt;&gt;&gt; (1,2,3)[1:3](2, 3)&gt;&gt;&gt; (1,2,3)+(1,2)(1, 2, 3, 1, 2)&gt;&gt;&gt; <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>字符串，列表，元组都是序列，都可以支持<strong>切片操作</strong></li><li>方法ord()获取对应的ascii码，len()方法获取元素个数，max(),min(),取最大最小元素</li></ul><pre class="line-numbers language-python" data-language="python"><code class="language-python">Python 3.9.2 (tags/v3.9.2:1a79785, Feb 19 2021, 13:44:55) [MSC v.1928 64 bit (AMD64)] on win32Type "help", "copyright", "credits" or "license()" for more information.&gt;&gt;&gt; len("hello world")11&gt;&gt;&gt; max("hello world")'w'&gt;&gt;&gt; min("hello world")' '&gt;&gt;&gt; ord("w")119&gt;&gt;&gt; <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>集合</strong></p><ul><li>以{}包含的是集合</li><li>集合满足数学上集合的特性，无序性，互异性，确定性</li><li>集合取差集用-号，取交集用&amp;，取合集用 |</li></ul><pre class="line-numbers language-python" data-language="python"><code class="language-python">Python 3.9.2 (tags/v3.9.2:1a79785, Feb 19 2021, 13:44:55) [MSC v.1928 64 bit (AMD64)] on win32Type "help", "copyright", "credits" or "license()" for more information.&gt;&gt;&gt; len({1,2,2})2&gt;&gt;&gt; 1 in {1,2}True&gt;&gt;&gt; 1 in {2,3}False&gt;&gt;&gt; 1 not in {2,3}True&gt;&gt;&gt; type({})&lt;class 'dict'&gt;&gt;&gt;&gt; type(set())&lt;class 'set'&gt;&gt;&gt;&gt; {1,2,3}-{3,4}{1, 2}&gt;&gt;&gt; {1,2,3} &amp; {3,4}{3}&gt;&gt;&gt; {1,2,3} | {3,4}{1, 2, 3, 4}&gt;&gt;&gt; <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>字典</strong></p><ul><li>以{key:value,key1:value1}这种形式的数据类型为字典，一个key对应一个value,key不能重复</li><li>访问字典中的元素必须用key来访问，key必须为不可变的数据类型，例如，int,str,tuple</li><li>空的字典用{}来定义</li></ul><pre class="line-numbers language-python" data-language="python"><code class="language-python">Python 3.9.2 (tags/v3.9.2:1a79785, Feb 19 2021, 13:44:55) [MSC v.1928 64 bit (AMD64)] on win32Type "help", "copyright", "credits" or "license()" for more information.&gt;&gt;&gt; type({})&lt;class 'dict'&gt;&gt;&gt;&gt; {"Q":"A","W":"B"}{'Q': 'A', 'W': 'B'}&gt;&gt;&gt; {"Q":"A","W":"B"}["Q"]'A'<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>数据类型思维导图</strong></p><ul><li><img src="https://s3.bmp.ovh/imgs/2021/09/883d7609737860ec.png" style="zoom:50%;"></li></ul><h2 id="变量与运算符"><a href="#变量与运算符" class="headerlink" title="变量与运算符"></a>变量与运算符</h2><p><strong>变量命名</strong></p><ul><li><p>命名不能用系统保留关键字</p></li><li><p>命名不能以数字开头，最好有意义</p></li><li><p>python变量没有类型限制</p></li><li><p>int str  tuple为值类型不可变 list set dict为引用类型可变</p></li></ul><pre class="line-numbers language-python" data-language="python"><code class="language-python">Python 3.9.2 (tags/v3.9.2:1a79785, Feb 19 2021, 13:44:55) [MSC v.1928 64 bit (AMD64)] on win32Type "help", "copyright", "credits" or "license()" for more information.&gt;&gt;&gt; a = "apple"&gt;&gt;&gt; id(a)2204424123120&gt;&gt;&gt; a=a+"banana"&gt;&gt;&gt; id(a)2204390996464&gt;&gt;&gt; <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>a为新生成的字符串并不是原来的字符串所以可改变</li></ul><p><strong>理解元组不可变而列表可变</strong></p><pre class="line-numbers language-python" data-language="python"><code class="language-python">Python 3.9.2 (tags/v3.9.2:1a79785, Feb 19 2021, 13:44:55) [MSC v.1928 64 bit (AMD64)] on win32Type "help", "copyright", "credits" or "license()" for more information.&gt;&gt;&gt; a = [1,2,3]&gt;&gt;&gt; id(a)2826926110208&gt;&gt;&gt; a[1]="2"&gt;&gt;&gt; id(a)2826926110208&gt;&gt;&gt; b=(1,2,[3,4])&gt;&gt;&gt; b[2][1]4&gt;&gt;&gt; b[2][1]=6&gt;&gt;&gt; print(b)(1, 2, [3, 6])&gt;&gt;&gt; <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>算术运算符</strong></p><ul><li>常见的+，-，*，/都可以</li><li>乘方用**，除法取整用//，取余数用%</li></ul><p><strong>赋值运算符</strong></p><ul><li>先赋值后运算</li><li>例如a+=1,就相当于a=a+1,其他类似</li></ul><p><strong>比较运算符（关系运算符）</strong></p><ul><li>返回的是布尔类型</li><li>不仅仅是数字才能比较，字母（转换成ascii码比较）,元组，列表按序号一个个比较</li></ul><p><strong>成员运算符</strong></p><ul><li>in 例如 1in [1,2,3] 返回True</li><li>not in 是否不在</li><li>返回的都是布尔类型</li></ul><p><strong>身份运算符</strong></p><ul><li>is 例如 1 is 1.0 返回False（比较的是内存地址）</li><li>有别于== ，比较的是值</li></ul><pre class="line-numbers language-python" data-language="python"><code class="language-python">Python 3.9.2 (tags/v3.9.2:1a79785, Feb 19 2021, 13:44:55) [MSC v.1928 64 bit (AMD64)] on win32Type "help", "copyright", "credits" or "license()" for more information.&gt;&gt;&gt; a={2,1,3}&gt;&gt;&gt; b={2,3,1}&gt;&gt;&gt; a==bTrue&gt;&gt;&gt; a is bFalse&gt;&gt;&gt; a=(2,1,3)&gt;&gt;&gt; b=(2,3,1)&gt;&gt;&gt; a==bFalse&gt;&gt;&gt; a is bFalse&gt;&gt;&gt; <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>位运算符</strong></p><ul><li>&amp;按位与 计算规则 先把数字转换为二进制一位位比较，如果都是1，返回1，否则返回0，再将计算结果转换为十进制输出</li><li>|按位或 计算规则 先把数字转换为二进制一位位比较，如果有一位是1，返回1，否则返回0，再将计算结果转换为十进制输出</li></ul><pre class="line-numbers language-python" data-language="python"><code class="language-python">Python 3.9.2 (tags/v3.9.2:1a79785, Feb 19 2021, 13:44:55) [MSC v.1928 64 bit (AMD64)] on win32Type "help", "copyright", "credits" or "license()" for more information.&gt;&gt;&gt; bin(2)'0b10'&gt;&gt;&gt; bin(3)'0b11'&gt;&gt;&gt; a=2&gt;&gt;&gt; b=3&gt;&gt;&gt; a&amp;b2&gt;&gt;&gt; a|b3&gt;&gt;&gt; <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>对象的三个特征</strong></p><ul><li>python 一切皆对象</li><li>对象的三个特征 值，类型，身份</li><li>判断身份除了type(),最好用isinstance(),第一个参数为要判断的变量，第二个参数为判断的类型，第二个参数可以是元组，可以是列表</li></ul><pre class="line-numbers language-python" data-language="python"><code class="language-python">Python 3.9.2 (tags/v3.9.2:1a79785, Feb 19 2021, 13:44:55) [MSC v.1928 64 bit (AMD64)] on win32Type "help", "copyright", "credits" or "license()" for more information.&gt;&gt;&gt; a=1&gt;&gt;&gt; isinstance(a,int)True&gt;&gt;&gt; isinstance(a,(int,str))True&gt;&gt;&gt; <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>变量与运算符思维导图</strong></p><p><img src="https://s3.bmp.ovh/imgs/2021/09/77e9e8c4d017da03.png"></p><h2 id="分支，循环，条件，与枚举"><a href="#分支，循环，条件，与枚举" class="headerlink" title="分支，循环，条件，与枚举"></a>分支，循环，条件，与枚举</h2><p><strong>表达式</strong></p><ul><li>表达式(Expression)是运算符(operator)和操作数(operand)所构成的序列</li><li>同级表达式遵从左结合的运算规则(即从左向右进行)</li><li>含有赋值运算符的遵从右结合(即等号右边优先计算）</li></ul><pre class="line-numbers language-python" data-language="python"><code class="language-python">Python 3.9.2 (tags/v3.9.2:1a79785, Feb 19 2021, 13:44:55) [MSC v.1928 64 bit (AMD64)] on win32Type "help", "copyright", "credits" or "license()" for more information.&gt;&gt;&gt; a=1&gt;&gt;&gt; b=2&gt;&gt;&gt; c=2&gt;&gt;&gt; not a or b+2 ==cFalse&gt;&gt;&gt; (not a) or ((b+2) ==c)False&gt;&gt;&gt; <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>python变量和常量的命名规则</strong></p><ul><li>常量命名全部大写</li><li>变量用_连接，例如user_account，而不用userAccount</li></ul><p><strong>流程控制语句</strong></p><ul><li>if else</li></ul><pre class="line-numbers language-python" data-language="python"><code class="language-python">mood = Falseif mood :    print('go to left')else :    print('go to right')<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>输出结果</li></ul><pre class="line-numbers language-python" data-language="python"><code class="language-python">PS D:\py&gt; python c1.pygo to right<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><ul><li>简单的登录小程序</li></ul><pre class="line-numbers language-python" data-language="python"><code class="language-python">ACCOUNT="wwj"PASSWORD="123456"print("请输入账号")user_account = input()print("请输入密码")user_password = input()if user_account == ACCOUNT and user_password == PASSWORD:    print("登录成功")else:    print("登录失败")<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>elif用法</strong></p><ul><li>elif不能单独使用，必须和if语句配套使用</li><li>elif使代码更加简洁</li></ul><p><strong>错误分析</strong></p><pre class="line-numbers language-python" data-language="python"><code class="language-python">a = input()if a == 1:    print("apple")elif a== 2:    print("banana")else:    print("peach")<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>错误原因，代码无论输入什么都是输出“peach”，因为输入的是字符串，而判断的是数字</li></ul><p><strong>改进</strong></p><pre class="line-numbers language-python" data-language="python"><code class="language-python">a = input()a=int(a)if a == 1:    print("apple")elif a== 2:    print("banana")else:    print("peach")<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>添加语句 a=int(a)，强制转换成整数型</li><li>在进行简单判断时，不要思维定势，可以用简单的逻辑运算符代替</li></ul><p><strong>循环语句</strong></p><p><strong>while</strong></p><pre class="line-numbers language-python" data-language="python"><code class="language-python">counter = 1while counter &lt;= 10:    counter+=1    print(counter)else:    print("结束") <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>while循环容易出现死循环，一般用for代替</li></ul><p><strong>for in</strong></p><pre class="line-numbers language-python" data-language="python"><code class="language-python">a=[["apple","banana","peach"],(1,2,3)]for x in a:    for y in x:        print(y)else:    print("end")<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>for in常用于遍历字典 列表</li><li>for in 可以配合else使用</li></ul><p><strong>for in range()</strong></p><ul><li>指定次数循环</li></ul><pre class="line-numbers language-python" data-language="python"><code class="language-python">for x in range(1,10):    if x == 3:        break    print(x)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><ul><li>可以搭配break使用，直接跳出循环</li><li>也可以配合continue使用,除了判断的这个条件不执行，其他继续执行</li></ul><pre class="line-numbers language-python" data-language="python"><code class="language-python">for x in range(1,10):    if x == 3:        continue    print(x)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p><strong>切片代替for</strong></p><pre class="line-numbers language-python" data-language="python"><code class="language-python">a=[1,2,3,4,5,6,7,8]for x in range(0,len(a),2):    print(a[x])<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><ul><li>可以打印出，1，3，5，7</li></ul><pre class="line-numbers language-python" data-language="python"><code class="language-python">a=[1,2,3,4,5,6,7,8]# for x in range(0,len(a),2):#     print(a[x])b=a[0:len(a):2]print(b)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>用切片一样可以代替</li></ul><h2 id="包，模块，函数，变量的作用域"><a href="#包，模块，函数，变量的作用域" class="headerlink" title="包，模块，函数，变量的作用域"></a>包，模块，函数，变量的作用域</h2><p><strong>python项目的组织结构</strong></p><ul><li>包，模块，类，函数，变量</li></ul><p><strong>导入模块</strong></p><ul><li>方法一</li><li>import方法</li></ul><pre class="line-numbers language-python" data-language="python"><code class="language-python">import t.c4 print(t.c4.a)print(t.c4.b)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><ul><li>方法二</li><li>简化写法 import as</li><li>将模块名在引用时重命名达到简写的目的</li></ul><pre class="line-numbers language-python" data-language="python"><code class="language-python">import t.c4 as wprint(w.a)print(w.b)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><ul><li>方法三</li><li>from 模块 import * 导入包内所有变量，也可引入单个变量</li></ul><pre class="line-numbers language-python" data-language="python"><code class="language-python">from t.c4 import *print(a)print(b)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><ul><li>方法四</li><li>方法三的加强，在要导入的模块添加“__all__”变量,限制引入的变量</li></ul><pre class="line-numbers language-python" data-language="python"><code class="language-python">__all__=["a","b","c"]a = 1b = 2c = 3<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><ul><li>方法五</li><li>from 包 引入 模块</li></ul><pre class="line-numbers language-python" data-language="python"><code class="language-python">from t import c4print(c4.a)print(c4.b)print(c4.c)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><ul><li>包文件中有一个__init__.py的头文件，导入包时会优先执行头文件中的内容</li><li>可以在头文件中添加<strong>all</strong>变量来限制导入的内容</li><li>导入包时禁止循环导入，python会自动报错</li></ul><pre class="line-numbers language-python" data-language="python"><code class="language-python">__all__=["a"]a = 1<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><ul><li>方法六</li><li>引入多个变量可以使用都好隔开</li></ul><pre class="line-numbers language-python" data-language="python"><code class="language-python">from t.c4 import a,b,c print(a)print(b)print(c)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p><strong>内置变量</strong></p><ul><li>可以用**dir()**函数查看当前模块内的所有变量(包括内置的)</li></ul><pre class="line-numbers language-python" data-language="python"><code class="language-python">infos = dir()print(infos)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><strong>绝对导入和相对导入</strong></p><ul><li>入口文件不能用相对导入</li><li>模块可以相对导入，但是不能超过顶级包</li><li>入口文件可以直接导入</li></ul><h2 id="Python函数"><a href="#Python函数" class="headerlink" title="Python函数"></a>Python函数</h2><p><strong>特性</strong></p><ul><li>功能性</li><li>隐藏细节</li><li>避免编写重复的代码</li></ul><p><strong>自定义函数</strong></p><ul><li>def 函数名():</li></ul><p><strong>自己定义的加法函数和打印函数</strong></p><pre class="line-numbers language-python" data-language="python"><code class="language-python">def add(x,y):    result=x+y    return resultdef printing(code):    print(code)print(add(1,2))printing("test")<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>让函数返回多个结果</strong></p><pre class="line-numbers language-python" data-language="python"><code class="language-python">def add(x,y):    result1=x+y    result2=x*y    return result1,result2a,b = add(1,2)print(a,b)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>return多个值以逗号隔开</li></ul><p><strong>序列解包与链式赋值</strong></p><ul><li>序列解包</li></ul><pre class="line-numbers language-python" data-language="python"><code class="language-python">a = 1,2,3b,c,d=aprint(b,c,d)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><ul><li>链式赋值</li></ul><pre class="line-numbers language-python" data-language="python"><code class="language-python">a=b=c=1print(a,b,c)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><strong>形参和实参</strong></p><ul><li>函数中定义的参数为形式参数</li><li>调用时传入的参数为实际参数</li></ul><p><strong>必须参数和关键字参数</strong></p><ul><li>必须参数函数执行时必须要传递的函数</li><li>关键字参数可以解决调用时参数的位置</li></ul><pre class="line-numbers language-python" data-language="python"><code class="language-python">def add(x,y):#x,y即为形式参数    result1=x+y    result2=x*y    return result1,result2a,b = add(y=1,x=2)#1,2为实际参数print(a,b)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>默认参数</strong></p><ul><li>即在函数调用中需要重复传入的参数可以使用默认参数</li></ul><pre class="line-numbers language-python" data-language="python"><code class="language-python">def student_file(name,gender="男",age="18",college="人民路小学"):    print("我叫"+name)    print("性别"+gender)    print("我今年"+age+"岁")    print("我在"+college+"上学")student_file("卢本伟")<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>默认参数可以修改，在调用时传入即可</li></ul><pre class="line-numbers language-python" data-language="python"><code class="language-python">def student_file(name,gender="男",age="18",college="人民路小学"):    print("我叫"+name)    print("性别"+gender)    print("我今年"+age+"岁")    print("我在"+college+"上学")student_file("卢本伟","女")<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>也可以搭配关键字参数使用</li></ul><pre class="line-numbers language-python" data-language="python"><code class="language-python">def student_file(name,gender="男",age="18",college="人民路小学"):    print("我叫"+name)    print("性别"+gender)    print("我今年"+age+"岁")    print("我在"+college+"上学")student_file("卢本伟",gender="女")<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>可变参数</strong></p><ul><li>用于接收一组数据，例如元组，列表</li></ul><pre class="line-numbers language-python" data-language="python"><code class="language-python">def demo(*param):    print(param)    sum=0    for x in param:        sum+=x*x    print(sum)demo(1,2,3)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>关键字可变参数</strong></p><ul><li>接收一组数据，一般为字典</li></ul><pre class="line-numbers language-python" data-language="python"><code class="language-python">def city_tem(**param):    for x,y in param.items():        print(x,y)a = {"bj":"32c","hz":"25c"}city_tem(**a)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>变量的作用域</strong></p><pre class="line-numbers language-python" data-language="python"><code class="language-python">c = 1 #全局变量def demo():    a=1 #局部变量    print(c)demo()<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>变量的作用域链</strong></p><ul><li>就近优先原则</li></ul><p><strong>global</strong></p><pre class="line-numbers language-python" data-language="python"><code class="language-python">def demo():    global a    a=1demo()print(a)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>使函数内部的局部变量转换成全局变量供外部调用</li></ul><h2 id="面向对象"><a href="#面向对象" class="headerlink" title="面向对象"></a>面向对象</h2><ul><li>知道什么是对象</li><li>知道什么是类</li></ul><p><strong>类的命名</strong></p><ul><li>类的命名首字母大写</li><li>类的命名单词连接都大写</li></ul><p><strong>类=面向对象</strong></p><ul><li>类的最基本作用:封装</li><li>用特征(数据成员),和行为描述类</li></ul><p><strong>类是一个模板，通过类可以实例化很多个对象</strong></p><p><strong>构造函数</strong></p><ul><li>作用:初始化对象的属性</li></ul><pre class="line-numbers language-python" data-language="python"><code class="language-python">class Student():    name = "wwj"    age = 1    def __init__(self,name,age):        self.name=name        self.age=age        print(self.name)    def demo(self):        print("name"+self.name)        print("age"+str(self.age))student = Student("石敢当",18)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>类变量和实例变量</strong></p><ul><li>在类下直接定义的是类变量</li><li>在方法中定义的为实例变量</li></ul><p><strong>方法下的变量要实例化</strong></p><ul><li>方法下的变量要用self.的前缀实例化</li></ul><pre class="line-numbers language-python" data-language="python"><code class="language-python">self.name=name<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong>调用类变量</strong></p><ul><li>可以通过<strong>类.变量名</strong>访问</li></ul><pre class="line-numbers language-python" data-language="python"><code class="language-python">print(Student.name)<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong>实例方法中访问类变量</strong></p><ul><li>方法一 类.变量名</li><li>方法二 通过self</li></ul><pre class="line-numbers language-python" data-language="python"><code class="language-python">print(self.__class__.name)<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong>类方法</strong></p><ul><li>通过类方法可以修改类变量的数值</li></ul><pre class="line-numbers language-python" data-language="python"><code class="language-python">class Student():    name = "wwj" #这是类变量    age = 1    sum=0    def __init__(self,name,age):        # self.name=name        self.name=name  #这是实例变量        print(self.__class__.name)    def demo(self):        print("name"+self.name)        print("age"+str(self.age))    @classmethod    def plus_sum(cls):        cls.sum+=1        print(cls.sum)        student = Student("石敢当",18)Student.plus_sum()<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>类方法的官方推荐关键字<strong>cls</strong></li><li>在定义实例函数前添加<strong>装饰器@classmethod</strong>后为<strong>类方法</strong></li></ul><p><strong>静态方法不常用</strong></p><ul><li>当方法与对象和类关系不大时可以使用静态方法</li><li>没有类似self,cls的关键字</li></ul><pre class="line-numbers language-python" data-language="python"><code class="language-python">    @staticmethod    def add():        print("This is a static method")        student = Student("石敢当",18)Student.add()student.add()<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>静态方法和类方法调用类变量的区别</strong></p><pre class="line-numbers language-python" data-language="python"><code class="language-python">@classmethoddef plus_sum(cls):    cls.sum+=1    print(cls.sum)#这是类方法调用类变量@staticmethoddef add():    print("This is a static method")    print(Student.name)#这是静态方法调用类变量<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>成员可见性</strong></p><ul><li>当类下的方法或变量以双下划线开头命名，python会认为该方法为私有方法，禁止外部调用</li></ul><pre class="line-numbers language-python" data-language="python"><code class="language-python">    def get_socre(self,score):        self.__score = score        print(self.name+"同学本次的考试成绩"+str(self.__score))student = Student("石敢当",18)student.get_socre(51)student.__score=-1<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-json" data-language="json"><code class="language-json">{'name': '石敢当', '_Student__score': 51, '__score': -1}<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ul><li>python的成员私有机制是通过改名的方式实现</li><li>还是可以访问</li><li>为了类中的数据安全，在修改类中的数据时，不应该直接访问而是通过方法传入</li></ul><p><strong>继承</strong></p><ul><li>子类调用父类变量</li></ul><pre class="line-numbers language-python" data-language="python"><code class="language-python">from c3 import Humanclass Student(Human):    def __init__(self,school,name,age):        self.school=school        Human.__init__(self,name,age)#这种方法不可取    def do_homework(self):        print("do english homework")        # super(Student, self).__init__(*args))student1=Student("人民路小学","石敢当",18)        print(student1.name)print(student1.age)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>用super正确继承父类方法和变量</li></ul><pre class="line-numbers language-python" data-language="python"><code class="language-python">from c3 import Humanclass Student(Human):    def __init__(self,school,name,age):        self.school=school        # Human.__init__(self,name,age)        super(Student, self).__init__(name,age)  #正确调用    def do_homework(self):        print("do english homework")student1=Student("人民路小学","石敢当",18)        print(student1.name)print(student1.age)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>子类继承父类思维导图</strong></p><img src="https://s3.bmp.ovh/imgs/2021/09/6030e7eb14d5fd91.png" style="zoom:50%;"><p><strong>python类思维导图</strong></p><img src="https://s3.bmp.ovh/imgs/2021/09/7dfe4268272b4da2.png" style="zoom: 50%;"><h2 id="正则表达式与json"><a href="#正则表达式与json" class="headerlink" title="正则表达式与json"></a>正则表达式与json</h2><p><strong>正则表达式</strong></p><ul><li>正则表达式是一个特殊的字符序列</li><li>一串字符是否与我们设定的这样的字符序列相匹配</li><li>快速检索文本，实现一些替换文本的操作</li></ul><p><strong>Python一些内置的文本处理函数</strong></p><pre class="line-numbers language-python" data-language="python"><code class="language-python">a = "C|C++|Java|Python"print(a.index("Python")&gt;-1)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">print("Python" in a)<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong>初识正则</strong></p><ul><li>re包有支持正则的依赖</li></ul><pre class="line-numbers language-python" data-language="python"><code class="language-python">import rea = "C|C++|Java|Python"# print(a.index("Python")&gt;-1)# print("Python" in a)r=re.findall("Python",a)print(r)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>匹配数字</strong></p><pre class="line-numbers language-python" data-language="python"><code class="language-python">import rea = "C0C++1Java2Python"# print(a.index("Python")&gt;-1)# print("Python" in a)r=re.findall("\d",a)print(r)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>字符集</strong></p><pre class="line-numbers language-python" data-language="python"><code class="language-python">import res ='abc,acc,adc,aec,afc'r=re.findall('a[a-f]c',s)#r=re.findall('^a[a-f]c',s)print(r)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>类似于e中的文本_取出中间文本</li><li>在前面加^可以达到取反的效果</li><li>中括号内的为概括字符集</li></ul><p><strong>概括字符集</strong></p><ul><li>/d 匹配数字 /D匹配非数字</li><li>/w单词字符 /W非单词字符</li><li>/s空白字符 /S非空白字符</li><li>.号匹配除\n以外所有的字符</li></ul><pre class="line-numbers language-python" data-language="python"><code class="language-python">import rea = "python66java779php"r = re.findall('\w',a)print(r)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p><strong>数量词</strong></p><ul><li>在正则表达式后添加{}数量区间，以逗号隔开可以匹配多个字符</li></ul><pre class="line-numbers language-python" data-language="python"><code class="language-python">import rea = 'python 111 java 222php'r = re.findall('[a-z]{3,6}',a)print(r)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p><strong>贪婪与非贪婪</strong></p><ul><li>在正则表达式数量词后添加?执行非贪婪搜索</li><li>Python默认会进行贪婪搜索</li></ul><pre class="line-numbers language-python" data-language="python"><code class="language-python">import rea = 'python 111 java 222php'r = re.findall('[a-z]{3,6}?',a)print(r)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p><strong>匹配0次,1次或者无限多次</strong></p><ul><li>*号匹配0次或无限多次</li><li>+号匹配1次或无限多次</li><li>?号匹配0次或1次</li></ul><pre class="line-numbers language-python" data-language="python"><code class="language-python">import rea = 'pytho11python33pythonn'r =re.findall('python*',a)print(r)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p><strong>边界匹配符</strong></p><ul><li>^开始$结尾表示匹配一整个文本</li></ul><pre class="line-numbers language-python" data-language="python"><code class="language-python">import reqq = '10000'r = re.findall('^\d{4,8}$',qq)print(r)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p><strong>组</strong></p><ul><li>用()包含起来就是一组</li><li>[]包含起来里的每个字母是或的关系</li></ul><pre class="line-numbers language-python" data-language="python"><code class="language-python">import rea = 'wwjwwjwwj'r = re.findall('(wwj){3}',a)print(r)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p><strong>匹配模式参数</strong></p><ul><li>findall()函数第三个参数是匹配模式</li><li>re.I表示忽略大小写匹配,re.S表示匹配所有字符包括换行符</li></ul><pre class="line-numbers language-python" data-language="python"><code class="language-python">import rea = 'wwjC#\nwwjwwj'r = re.findall('c#.{1}',a,re.I | re.S)print(r)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p><strong>re.sub正则替换</strong></p><pre class="line-numbers language-python" data-language="python"><code class="language-python">import re a = 'phpgojavac#'r = re.sub('c#','python',a,0)print(r)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><ul><li>也可以使用.replace方法实现</li></ul><p><strong>把函数作为参数传入</strong></p><pre class="line-numbers language-python" data-language="python"><code class="language-python">import res = 'a1b4j1k4l9s8d9g0s0w1'def convert(value):    matched = value.group()    if int(matched) &gt;=6:        return '9'    else:        return '0'r = re.sub('\d',convert,s)print(r)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>search和match函数</strong></p><pre class="line-numbers language-python" data-language="python"><code class="language-python">import res = 'a1b4j1k4l9s8d9g0s0w1'r = re.search('\d',s)r1 = re.match('\d',s)print(r)print(r1)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>search将搜寻整个文本，如果找到匹配立刻停止并且返回</li><li>match会从开头开始匹配，如果失败立刻终止</li></ul><p><strong>group分组</strong></p><pre class="line-numbers language-python" data-language="python"><code class="language-python">import res = 'life is short,i love python'#目的取出life 和 python中间的文本r =re.search('life(.*) python',s)print(r.group(1))#要匹配结果从1开始#类似于易语言中的文本_取出中间文本<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>学习正则的建议</strong></p><ul><li>常用正则可以使用他人写好的,但要自己研究一下</li><li>常用常记，熟能生巧</li></ul><p><strong>理解json</strong></p><ul><li>什么是json: Javascript object notion</li><li>是一种轻量级的数据交换格式</li><li>字符串是json的表现形式</li><li>复合json规范的加json字符串</li></ul><p><strong>json的优势</strong></p><ul><li>易于阅读</li><li>易于解析</li><li>网络传输效率高</li><li>反序列化-将json解析成语言所对应的格式</li><li>序列化-将语言所对应的格式组装成json</li></ul><h2 id="Python的高级语法与用法"><a href="#Python的高级语法与用法" class="headerlink" title="Python的高级语法与用法"></a>Python的高级语法与用法</h2><h2 id="函数式编程"><a href="#函数式编程" class="headerlink" title="函数式编程"></a>函数式编程</h2><h2 id="实战-原生爬虫"><a href="#实战-原生爬虫" class="headerlink" title="实战:原生爬虫"></a>实战:原生爬虫</h2><h2 id="Pythonic与Python杂记"><a href="#Pythonic与Python杂记" class="headerlink" title="Pythonic与Python杂记"></a>Pythonic与Python杂记</h2>]]></content>
      
      
      <categories>
          
          <category> python </category>
          
      </categories>
      
      
        <tags>
            
            <tag> coding </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>商大云战役</title>
      <link href="/2021/08/11/yun-zhan-yi/"/>
      <url>/2021/08/11/yun-zhan-yi/</url>
      
        <content type="html"><![CDATA[<h2 id="sparkles-项目介绍"><a href="#sparkles-项目介绍" class="headerlink" title=":sparkles:项目介绍"></a><span class="github-emoji"><span>✨</span><img src="https://github.githubassets.com/images/icons/emoji/unicode/2728.png?v8" aria-hidden="true" onerror="this.parent.classList.add('github-emoji-fallback')"></span>项目介绍</h2><p>​    伴随着疫情的到来，学校为了解在校师生的健康状况，全校师生都规定在特定的时间进行健康打卡 or 校内打卡，本项目旨在帮助使用<strong>商大云战疫</strong>打卡的在校师生提供帮助，每天指定时间进行自动打卡，从每天指定时间打卡的压力中解放出来，全身心地投入到社会主义建设之中去。</p><h2 id="🔰项目功能"><a href="#🔰项目功能" class="headerlink" title="🔰项目功能"></a>🔰项目功能</h2><ul><li>[x]商大云战役模拟登录取cookie</li><li>[x]自定义地址</li><li>[x]每天0点自动打卡，并在打卡后返回打卡结果</li><li>[x]支持多人同时打卡</li><li>[x]支持喵提醒，pushplus推送</li></ul><h2 id="🎨配置文件"><a href="#🎨配置文件" class="headerlink" title="🎨配置文件"></a>🎨配置文件</h2><h3 id="💃用户配置"><a href="#💃用户配置" class="headerlink" title="💃用户配置"></a>💃用户配置</h3><ul><li>修改账号密码未自己的账号密码</li><li>修改省份详细地址为自己的地址</li><li>修改<strong>pushplus</strong>的token为自己的token</li></ul><h3 id="🤝统一推送配置"><a href="#🤝统一推送配置" class="headerlink" title="🤝统一推送配置"></a>🤝统一推送配置</h3><ul><li>默认使用pushplus推送</li><li>当然你可以其他推送渠道，前提自己会写</li><li>不懂代码别乱改</li></ul><h2 id="💦使用方法（云函数）"><a href="#💦使用方法（云函数）" class="headerlink" title="💦使用方法（云函数）"></a>💦使用方法（云函数）</h2><ul><li><strong>beta测试版，时间紧急写的仓促</strong></li></ul><pre class="line-numbers language-python" data-language="python"><code class="language-python">import requestsimport timeimport jsonDATA=[{"1111111111":"111111"}]#你的账号密码log=[]PUSH_TOKEN='填写你的密钥'#你的密钥LOGIN_URL = 'https://nco.zjgsu.edu.cn/login'SUBMIT_URL='https://nco.zjgsu.edu.cn/'LOGIN_HEADER={    "User-Agent":"Mozilla/5.0 (iPhone; CPU iPhone OS 13_2_3 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/13.0.3 Mobile/15E148 Safari/604.1 Edg/93.0.4577.82",    'Content-Type': 'application/x-www-form-urlencoded'}LOGIN_BODY={    "name":"",    "psswd":""}SUBMIT_BODY={        'uuid':'a59e0ac8-da06-4fb1-83d8-000976c317a9',        'locationInfo': '浙江省', #可以修改        'currentResd': '浙江省杭州市江干区浙江工商大学钱江湾生活园区', #可以修改        'fromHbToZjDate': '',        'fromHbToZj': 'C',        'fromWtToHzDate': '',        'fromWtToHz': 'B',        'meetDate': '',        'meetCase': 'C',        'travelDate': '',        'travelCase': 'D',        'medObsvReason': '',        'medObsv': 'B',        'belowCaseDesc': '',        'belowCase': 'D',        'temperature': '',        'notApplyReason': '',        'hzQRCode': 'A',        'specialDesc': ''}def nco():    for x in DATA:        for u,p in x.items():            LOGIN_BODY['name']=u            LOGIN_BODY['psswd']=p            response=requests.post(url=LOGIN_URL,headers=LOGIN_HEADER,data=LOGIN_BODY)            cookies = response.cookies            submit_response=requests.post(SUBMIT_URL,headers=LOGIN_HEADER,cookies=cookies,data=SUBMIT_BODY)            if '报送成功' in submit_response.text:                print("账号："+u+"当天已填报")                log.append("账号："+u+"********填报成功！********")            else:                log.append("账号："+u+"********填报失败！********")                print("账号："+u+"当天未填报")        time.sleep(0.002)  def push():    token = PUSH_TOKEN    title= '浙工商打卡小助手提示您'     content =log    url = 'http://pushplus.hxtrip.com/send'    data = {    "token":token,    "title":title,    "content":content,    "template":"html"    }    body=json.dumps(data).encode(encoding='utf-8')    headers = {'Content-Type':'application/json'}    requests.post(url,data=body,headers=headers)    print('发送成功')def main_handler(event, context):    nco()    push()if __name__=='__main__':    nco()       push()<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="cloud-腾讯云函数配置"><a href="#cloud-腾讯云函数配置" class="headerlink" title=":cloud:腾讯云函数配置"></a><span class="github-emoji"><span>☁</span><img src="https://github.githubassets.com/images/icons/emoji/unicode/2601.png?v8" aria-hidden="true" onerror="this.parent.classList.add('github-emoji-fallback')"></span>腾讯云函数配置</h2><ul><li><p>打开云函数官网<a href="https://console.cloud.tencent.com/scf/list?rid=1&amp;ns=default">云函数官网-函数服务 - Serverless - 控制台 (tencent.com)</a></p></li><li><img src="https://s3.bmp.ovh/imgs/2021/09/bab2dc4bffe0cdbd.png" style="zoom:50%;"></li><li><p>选择自定义创建，其他配置默认</p></li><li><img src="https://s3.bmp.ovh/imgs/2021/09/66d42986c9fc299a.png" style="zoom:50%;"></li><li><p>配置触发器配置 选择触发周期为每天0点</p></li></ul><h2 id="runner-其他版本"><a href="#runner-其他版本" class="headerlink" title=":runner:其他版本"></a><span class="github-emoji"><span>🏃</span><img src="https://github.githubassets.com/images/icons/emoji/unicode/1f3c3.png?v8" aria-hidden="true" onerror="this.parent.classList.add('github-emoji-fallback')"></span>其他版本</h2><ul><li>已开发易语言和Python版本</li><li>未来会提供网页版本和小程序版本</li></ul>]]></content>
      
      
      <categories>
          
          <category> python </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 云函数 </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
